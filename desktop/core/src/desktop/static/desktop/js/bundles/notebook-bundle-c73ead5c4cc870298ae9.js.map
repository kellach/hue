{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./desktop/core/src/desktop/js/apps/notebook/notebook.js","webpack:///./desktop/core/src/desktop/js/apps/notebook/notebook.ko.js","webpack:///./desktop/core/src/desktop/js/ext/bootstrap-datepicker.min.js","webpack:///./desktop/core/src/desktop/js/jquery/plugins/jquery.hdfstree.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","notebook","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","__webpack_exports__","clipboard__WEBPACK_IMPORTED_MODULE_2__","clipboard__WEBPACK_IMPORTED_MODULE_2___default","apps_notebook_notebook_ko__WEBPACK_IMPORTED_MODULE_3__","Clipboard","EditorViewModel","NOTEBOOK_MAPPING","ignore","COMPATIBILITY_SOURCE_PLATFORMS","teradata","oracle","netezza","impala","hive","db2","greenplum","mysql","postgresql","informix","sqlserver","sybase","access","firebird","ansisql","generic","COMPATIBILITY_TARGET_PLATFORMS","Result","snippet","self","this","$","extend","chartType","chartTimelineType","id","ko","observable","hueUtils","UUID","type","hasResultset","handle","meta","observableArray","adaptMeta","forEach","item","checked","subscribe","filteredMetaChecked","filteredMeta","some","replace","toLowerCase","originalIndex","isNumericColumn","inArray","isDateTimeColumn","isStringColumn","isComplexColumn","rows","hasMore","statement_id","statement_range","start","row","column","end","statements_count","previous_statement_hash","cleanedMeta","computed","utils","arrayFilter","metaFilter","isMetaFilterVisible","pureComputed","query","filter","facets","isFacetMatch","keys","isTextMatch","text","match","every","indexOf","autocompleteFromEntries","nonPartial","partial","partialLower","substring","clickFilteredMetaCheck","fetchedOnce","startTime","Date","endTime","executionTime","getTime","cleanedNumericMeta","cleanedStringMeta","cleanedDateTimeMeta","rateLimit","explanation","images","logs","logLines","hasSomeResults","getContext","clear","removeAll","has_more_statements","cancelBatchExecution","getDefaultSnippetProperties","snippetType","properties","ERROR_REGEX","Snippet","vm","newVal","status","isBatchable","grep","availableLanguages","language","interface","autocompleteSettings","temporaryOnly","aceCursorPosition","isHistory","aceEditor","ace","isPresentationMode","focus","errors","aceErrorsHolder","aceWarningsHolder","aceErrors","showOptimizer","aceWarnings","availableSnippets","inFocus","newValue","huePubSub","publish","editorMode","getAceMode","getSnippetViewSettings","aceMode","dbSelectionVisible","showExecutionAnalysis","isSqlDialect","sqlDialect","getPlaceHolder","placeHolder","getApiHelper","apiHelper","namespace","undefined","compute","whenContextSet","namespaceSub","computeSub","namespaceDeferred","Deferred","resolve","dispose","computeDeferred","when","reject","availableDatabases","database","previousDatabase","setInTotalStorage","currentQueryTab","pinnedContextTabs","removeContextTab","context","tabId","remove","errorLoadingQueries","loadingQueries","queriesHasErrors","queriesCurrentPage","selectedNotebook","snippets","queriesTotalPages","queries","queriesFilter","queriesFilterVisible","method","timeout","val","fetchQueries","lastFetchQueriesRequest","cancelActiveRequest","lastQueriesPage","searchDocuments","successCallback","Math","ceil","count","komapping","fromJS","documents","errorCallback","page","limit","include_trashed","prevQueriesPage","nextQueriesPage","subscribeOnce","source","huePubSubId","ignoreNextAssistDatabaseUpdate","handleAssistSelection","databaseDef","sourceType","callback","statementType","statementTypes","statementPath","getExternalStatement","externalStatementLoaded","post","toJSON","statement_raw","statement","setValue","_ajaxError","associatedDocumentLoading","associatedDocument","associatedDocumentUuid","selectedStatement","positionStatement","lastExecutedStatement","statementsList","statementDetails","container","activeStatement","_statements","precedingStatements","followingStatements","isPresentationModeInitialized","isPresentationModeDefault","aceSize","statusForButtons","hasProperties","toJS","viewSettings","previousProperties","oldValue","setTimeout","variables","variable","_typeof","defaultValue","placeholder","sample","sampleUser","path","step","document","trigger","hasCurlyBracketParameters","getPigParameters","params","declares","defaults","macro_defines","macro_returns","each","index","param","line","params_line","param_line","variableNames","matchList","matches","re","reComment","reList","matchComment","exec","_loop","option","trim","options","current","unshift","map","variableValues","diffLengthVariables","needsMore","needsLess","reduce","catalogEntry","abs","concat","activeSourcePromises","e","promise","pop","cancel","oLocations","locations","location","colRef","updateVariableType","sourceMeta","variablesValues","moment","utc","format","now","resolveCatalogEntry","cancellable","done","entry","join","getSourceMeta","silenceErrors","then","variablesString","RegExp","p1","p2","pad","showGrid","showChart","defaultShowLogs","totalStorage","showLogs","progress","jobs","executeNextTimeout","refreshTimeouts","prepopulateChart","hueAnalytics","log","HUE_CHARTS","TYPES","MAP","chartX","fld","chartYSingle","BARCHART","PIECHART","GRADIENTMAP","chartYMulti","LINECHART","SCATTERCHART","chartXPivot","min","guessMetaField","field","_fld","onDdlExecute","clearTimeout","execute","test","firstToken","dataCatalog","getEntry","clearCache","invalidate","cascade","isResultSettingsVisible","getLogs","isLoading","resultsKlass","errorsKlass","is_redacted","chartSorting","chartScatterGroup","chartScatterSize","chartScope","chartLimits","chartLimit","notify","chartData","chartMapType","chartMapLabel","chartMapHeat","hideStacked","hasDataForChart","TIMELINECHART","notifySubscribers","valueHasMutated","previousChartOptions","fields","_fields","_field","toggleResultSettings","settingsVisible","saveResultsModalVisible","checkStatusTimeout","wasBatchExecuted","complexity","hasComplexity","hasRisks","topRisk","suggestion","hasSuggestion","compatibilityCheckRunning","compatibilitySourcePlatforms","compatibilitySourcePlatform","compatibilityTargetPlatform","queryCompatibility","compatibilityTargetPlatforms","getFromTotalStorage","HAS_OPTIMIZER","isNotificationManager","lastComplexityRequest","lastCheckedComplexityStatement","knownResponses","delayedStatement","handleRiskResponse","query_complexity","hints","editor","risks","clearActiveRisks","newStatement","hash","hashCode","knownResponse","checkComplexity","syntaxError","changeSubscription","ajax","url","success","always","existingSession","getSession","restartSession","createSession","Session","message","help","col","retryModalCancel","retryModalConfirm","errorCol","errorLine","parseInt","first_column","first_line","isReady","app_jar","class","jars","command_path","source_path","destination_path","lastExecuted","lastAceSelectionRowOffset","executingBlockingOperation","showLongOperationWarning","convert","lastCompatibilityRequest","longOperationTimeout","startLongOperationTimeout","stopLongOperationTimeout","lastExecutedStatements","lastExecutedSelectionRange","automaticallyTriggered","selectionRange","getSelectionRange","isCanceling","autoExpand","_getPreviousChartOptions","forceHistoryInitialHeight","close","historyCurrentPage","sqlStatementsParser","parse","history_id","isMobile","isHue4","URLS","hue4","changeURL","uuid","history_uuid","parentSavedQueryUuid","history_parent_uuid","has_result_set","sync","loadData","unloaded","checkStatus","isOptimizerEnabled","isExecutingAll","tasks","history","_makeHistoryRecord","fail","xhr","textStatus","errorThrown","responseText","reexecute","formatEnabled","formatSql","statements","getSelectedText","session","selection","getRange","formatted_statements","explain","checkCompatibility","targetPlatform","sourcePlatform","query_compatibility","queryError","errorString","parseError","fetchResult","startOver","fetchResultData","isFetchingData","fetchExecutionAnalysis","analysisPossible","queryId","JSON","bigdataParse","_initialIndex","_tempData","has_more","initial","comment","cssClass","newSnippet","fetchResultMetadata","fetchResultSize","query_id","query_status","delay","_query_id","checkDdlNotification","executingAllIndex","successUrl","href","abort","isEmptyObject","from","full_log","split","oldLogs","isFullLogs","job","percentJob","_found","uploadQueryHistory","upload_history","watchUploadStatus","workloadId","uploadQuery","uploadTableStats","showProgress","db_tables","activeTables","table","databaseName","tableName","with_ddl","with_table_stats","with_columns_stats","upload_table_ddl","upload_status","state","statusMsg","failedQueries","failQueryDetails","error","getSimilarQueries","console","statement_similarity","autocompleter","Autocompleter","user","optEnabled","autocompleteTimeout","useNewAutocompleter","init","onKeydownInVariable","ctrlKey","metaKey","which","commands","preventDefault","selectedSessionProperty","restarting","isObservable","availableNewProperties","addedIndex","availableSessionProperties","Notebook","description","initialType","coordinatorUuid","is_history","isManaged","isSaved","canWrite","can_write","onSuccessUrl","pubSubUrl","cancelExecutingAll","togglePresentationMode","presentationSnippets","isHidingCode","selectedSnippet","editorType","creatingSessionLocks","sessions","directoryUuid","dependents","dependentsCoordinator","doc","is_managed","historyFilter","IS_EMBEDDED","historyFilterVisible","fetchHistory","loadingHistory","historyInitialHeight","throttle","historyTotalPages","schedulerViewModel","schedulerViewModelIsLoaded","schedulerViewerViewModel","avoidClosing","canSave","session_type","_s","getSnippets","unload","currentQueries","closeSession","addSession","toRemove","addSnippet","skipSession","_snippet","failCallback","cluster","authSession","authSessionType","authSessionUsername","authSessionPassword","authSessionCallback","lastSnippet","newSnippetAbove","idx","cnt","move","save","cp","availableTimezones","wasHistory","save_as","existingQuery","last_modified","saveScheduler","coordinator","refreshParameters","loadScheduler","downloadResultViewModel","saveTarget","report","hue4_notebook","clearResults","executeAll","saveDefaultUserProperties","saveConfiguration","app","userId","closeAndRemoveSession","silent","doc_type","doc_text","is_notification_manager","parsedHistory","nbk","absoluteUrl","prevHistoryPage","nextHistoryPage","updateHistoryFailed","updateHistory","statuses","interval","items","updateHistoryCall","warn","clearHistory","CoordinatorEditorViewModel","_action","IS_HUE_4","opts","response","layout","html","credentials","workflows","can_edit","cleanNode","applyBindings","off","on","event","modal","height","cron_advanced","tracker","markCurrentStateAsClean","isEditing","isDirty","showSubmitPopup","viewSchedulerId","isSchedulerJobRunning","loadingScheduler","whenDatabaseAvailable","whenNamespaceAvailable","databaseSub","whenSnippetAvailable","snippetsSub","editor_id","notebooks","RunningCoordinatorModel","editorMobile","suffix","mobile","editor_type","changeURLParameter","preEditorTogglingSnippet","toggleEditorMode","_notebook","_newSnippets","_variables","_statementKeys","sql_statement","_title","_statement","startsWith","substr","editorTypeTitle","foundInterpreter","languages","interpreter","combinedContent","isPresentationModeEnabled","isResultFullScreenMode","success_url","is_optimizer_enabled","isNavigatorEnabled","is_navigator_enabled","sqlSourceTypes","snippetViewSettings","activeSqlSourceType","displayCombinedContent","toggleEditing","removeSnippetConfirmation","removeSnippet","hasContent","assistAvailable","assistWithoutStorage","isLeftPanelVisible","isRightPanelAvailable","isRightPanelVisible","withActiveSnippet","foundSnippet","isContextPanelVisible","activeSnippet","contents","exists","saveSnippetToFile","contextData","default","session_properties","getSessionProperties","_prop","prop","getSnippetName","openNotebook","getParameter","loadNotebook","newNotebook","notebookRaw","queryTab","aceAutoExpand","aceLineOffset","skipUrlChange","deferredOpen","dependencies","user_perms","directory_uuid","saveNotebook","saveAsNotebook","showContextPopover","$source","target","nodeName","parentElement","offset","onSampleClick","showInAssistEnabled","orientation","defaultDatabase","pinEnabled","element","left","top","right","width","bottom","parseFormat","picker","template","appendTo","click","proxy","mousedown","isInput","is","component","find","show","blur","hide","keyup","update","minViewMode","viewMode","startViewMode","weekStart","weekEnd","fillDow","fillMonths","showMode","constructor","outerHeight","place","stopPropagation","date","set","formatDate","parseDate","viewDate","getFullYear","getMonth","fill","css","dates","daysMin","append","monthsShort","valueOf","months","getDaysInMonth","setDate","getDay","a","u","getDate","empty","f","removeClass","eq","addClass","h","closest","className","modes","navFnc","navStep","parent","setMonth","setFullYear","clsName","max","fn","datepicker","Constructor","days","daysShort","isLeapYear","Error","separator","parts","setHours","setMinutes","setSeconds","setMilliseconds","yy","toString","yyyy","dd","mm","headTemplate","contTemplate","jquery__WEBPACK_IMPORTED_MODULE_0__","jquery__WEBPACK_IMPORTED_MODULE_0___default","_utils_hueUtils__WEBPACK_IMPORTED_MODULE_1__","jQuery","pluginName","home","initialPath","isS3","withTopPadding","onPathChange","createFolder","labels","CREATE_FOLDER","FOLDER_NAME","CANCEL","HOME","Plugin","HUE_I18n","jHueHdfsTree","_defaults","_name","lastPath","previousPath","optionalPath","_this","_homeLink","_el","_path","_tree","_paths","_re","showHdfsLeaf","paths","scroll","cursor","position","padding-bottom","font-size","border-bottom","background-color","scrollbarWidth","scrollTop","attr","BASE_PATH","escapeSingleQuote","removeLeadingSlash","autocompleteUrl","currentPath","shiftedPath","leaf","getJSON","filteredCurrentPath","_dataPathForCurrent","siblings","files","filteredPath","_escapedPath","_li","_destination","lastIndexOf","_createFolderLi","_createFolderDetails","_folderName","_folderBtn","slideUp","beforeSend","setRequestHeader","_newFolder","slideDown","jHueNotify","setOptions"],"mappings":"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","file":"notebook-bundle-c73ead5c4cc870298ae9.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"notebook\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1,\"vendors~hue~notebook\",\"vendors~notebook\",\"hue~notebook\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport 'ext/bootstrap-datepicker.min';\nimport 'jquery/plugins/jquery.hdfstree';\nimport Clipboard from 'clipboard';\nimport EditorViewModel from 'apps/notebook/notebook.ko';\n\nwindow.Clipboard = Clipboard;\nwindow.EditorViewModel = EditorViewModel;","// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport $ from 'jquery';\nimport ko from 'knockout';\nimport komapping from 'knockout.mapping';\nimport apiHelper from 'api/apiHelper';\nimport huePubSub from 'utils/huePubSub';\nimport hueUtils from 'utils/hueUtils';\n\nlet NOTEBOOK_MAPPING = {\n  ignore: [\n    'ace', 'aceMode', 'autocompleter', 'availableDatabases', 'availableSnippets', 'avoidClosing', 'canWrite',\n    'cleanedDateTimeMeta', 'cleanedMeta', 'cleanedNumericMeta', 'cleanedStringMeta', 'dependents', 'errorLoadingQueries',\n    'hasProperties', 'history', 'images', 'inFocus', 'queries', 'saveResultsModalVisible', 'selectedStatement',\n    'snippetImage', 'user', 'positionStatement', 'lastExecutedStatement', 'downloadResultViewModel'\n  ]\n};\n\nlet COMPATIBILITY_SOURCE_PLATFORMS ={\n  teradata: { name: 'Teradata', value: 'teradata' },\n  oracle: { name: 'Oracle', value: 'oracle' },\n  netezza: { name: 'Netezza', value: 'netezza' },\n  impala: { name: 'Impala', value: 'impala' },\n  hive: { name: 'Hive', value: 'hive' },\n  db2: { name: 'DB2', value: 'db2' },\n  greenplum: { name: 'Greenplum', value: 'greenplum' },\n  mysql: { name: 'MySQL', value: 'mysql' },\n  postgresql: { name: 'PostgreSQL', value: 'postgresql' },\n  informix: { name: 'Informix', value: 'informix' },\n  sqlserver: { name: 'SQL Server', value: 'sqlserver' },\n  sybase: { name: 'Sybase', value: 'sybase' },\n  access: { name: 'Access', value: 'access' },\n  firebird: { name: 'Firebird', value: 'firebird' },\n  ansisql: { name: 'ANSISQL', value: 'ansisql' },\n  generic: { name: 'Generic', value: 'generic' }\n};\n\nlet COMPATIBILITY_TARGET_PLATFORMS ={\n  impala: { name: 'Impala', value: 'impala' },\n  hive: { name: 'Hive', value: 'hive' }\n};\n\nlet Result = function (snippet, result) {\n  let self = this;\n\n  $.extend(snippet, snippet.chartType == 'lines' && { // Retire line chart\n      chartType: 'bars',\n      chartTimelineType: 'line'\n  });\n  self.id = ko.observable(typeof result.id != \"undefined\" && result.id != null ? result.id : hueUtils.UUID());\n  self.type = ko.observable(typeof result.type != \"undefined\" && result.type != null ? result.type : 'table');\n  self.hasResultset = ko.observable(typeof result.hasResultset != \"undefined\" && result.hasResultset != null ? result.hasResultset : true)\n    .extend(\"throttle\", 100);\n  self.handle = ko.observable(typeof result.handle != \"undefined\" && result.handle != null ? result.handle : {});\n  self.meta = ko.observableArray(typeof result.meta != \"undefined\" && result.meta != null ? result.meta : []);\n\n  let adaptMeta = function () {\n    let i = 0;\n    self.meta().forEach(function (item) {\n      if (typeof item.checked === 'undefined') {\n        item.checked = ko.observable(true);\n        item.checked.subscribe(function () {\n          self.filteredMetaChecked(self.filteredMeta().some(function (item) { return item.checked(); }));\n        });\n      }\n      item.type = item.type.replace(/_type/i, '').toLowerCase();\n      if (typeof item.originalIndex === 'undefined') {\n        item.originalIndex = i;\n      }\n      i++;\n    })\n  };\n\n  adaptMeta();\n  self.meta.subscribe(adaptMeta);\n\n\n  self.rows = ko.observable(typeof result.rows != \"undefined\" && result.rows != null ? result.rows : null);\n  self.hasMore = ko.observable(typeof result.hasMore != \"undefined\" && result.hasMore != null ? result.hasMore : false);\n  self.statement_id = ko.observable(typeof result.statement_id != \"undefined\" && result.statement_id != null ? result.statement_id : 0);\n  self.statement_range = ko.observable(typeof result.statement_range != \"undefined\" && result.statement_range != null ? result.statement_range : {\n    start: {\n      row: 0,\n      column: 0\n    },\n    end: {\n      row: 0,\n      column: 0\n    }\n  });\n  // We don't keep track of any previous selection so prevent entering into batch execution mode after load by setting\n  // statements_count to 1. For the case when a selection is not starting at row 0.\n  self.statements_count = ko.observable(1);\n  self.previous_statement_hash = ko.observable(typeof result.previous_statement_hash != \"undefined\" && result.previous_statement_hash != null ? result.previous_statement_hash : null);\n  self.cleanedMeta = ko.computed(function () {\n    return ko.utils.arrayFilter(self.meta(), function (item) {\n      return item.name != ''\n    });\n  });\n  self.metaFilter = ko.observable();\n\n  self.isMetaFilterVisible = ko.observable(false);\n  self.filteredMetaChecked = ko.observable(true);\n  self.filteredMeta = ko.pureComputed(function () {\n    if (!self.metaFilter() || self.metaFilter().query === '') {\n      return self.meta();\n    }\n\n    return self.meta().filter(function (item) {\n      let facets = self.metaFilter().facets;\n      let isFacetMatch = !facets || Object.keys(facets).length === 0 || !facets['type']; // So far only type facet is used for SQL\n      let isTextMatch = !self.metaFilter().text || self.metaFilter().text.length === 0;\n      let match = true;\n\n      if (!isFacetMatch) {\n        match = !!facets['type'][item.type];\n      }\n\n      if (match && !isTextMatch) {\n        match = self.metaFilter().text.every(function (text) {\n          return item.name.toLowerCase().indexOf(text.toLowerCase()) !== -1;\n        });\n      }\n      return match;\n    });\n  });\n\n  self.autocompleteFromEntries = function (nonPartial, partial) {\n    let result = [];\n    let partialLower = partial.toLowerCase();\n    self.meta().forEach(function (column) {\n      if (column.name.toLowerCase().indexOf(partialLower) === 0) {\n        result.push(nonPartial + partial + column.name.substring(partial.length))\n      } else if (column.name.toLowerCase().indexOf('.' + partialLower) !== -1) {\n        result.push(nonPartial + partial + column.name.substring(partial.length + column.name.toLowerCase().indexOf('.' + partialLower) + 1))\n      }\n    });\n\n    return result;\n  };\n  self.clickFilteredMetaCheck = function () {\n    self.filteredMeta().forEach(function (item) {\n      item.checked(self.filteredMetaChecked());\n    });\n  };\n\n  self.fetchedOnce = ko.observable(typeof result.fetchedOnce != \"undefined\" && result.fetchedOnce != null ? result.fetchedOnce : false);\n  self.startTime = ko.observable(typeof result.startTime != \"undefined\" && result.startTime != null ? new Date(result.startTime) : new Date());\n  self.endTime = ko.observable(typeof result.endTime != \"undefined\" && result.endTime != null ? new Date(result.endTime) : new Date());\n  self.executionTime = ko.computed(function () {\n    return self.endTime().getTime() - self.startTime().getTime();\n  });\n\n  function isNumericColumn(type) {\n    return $.inArray(type, ['tinyint', 'smallint', 'int', 'bigint', 'float', 'double', 'decimal', 'real']) > -1;\n  }\n\n  function isDateTimeColumn(type) {\n    return $.inArray(type, ['timestamp', 'date', 'datetime']) > -1;\n  }\n\n  function isComplexColumn(type) {\n    return $.inArray(type, ['array', 'map', 'struct']) > -1;\n  }\n\n  function isStringColumn(type) {\n    return !isNumericColumn(type) && !isDateTimeColumn(type) && !isComplexColumn(type);\n  }\n\n  self.cleanedNumericMeta = ko.computed(function () {\n    return ko.utils.arrayFilter(self.meta(), function (item) {\n      return item.name != '' && isNumericColumn(item.type)\n    });\n  });\n\n  self.cleanedStringMeta = ko.computed(function () {\n    return ko.utils.arrayFilter(self.meta(), function (item) {\n      return item.name != '' && isStringColumn(item.type)\n    });\n  });\n\n  self.cleanedDateTimeMeta = ko.computed(function () {\n    return ko.utils.arrayFilter(self.meta(), function (item) {\n      return item.name != '' && isDateTimeColumn(item.type)\n    });\n  });\n\n  self.data = ko.observableArray(typeof result.data != \"undefined\" && result.data != null ? result.data : []);\n  self.data.extend({ rateLimit: 50 });\n  self.explanation = ko.observable(typeof result.explanation != \"undefined\" && result.explanation != null ? result.explanation : '');\n  self.images = ko.observableArray(typeof result.images != \"undefined\" && result.images != null ? result.images : []);\n  self.images.extend({ rateLimit: 50 });\n  self.logs = ko.observable('');\n  self.logLines = 0;\n  self.hasSomeResults = ko.computed(function () {\n    return self.hasResultset() && self.data().length > 0; // status() == 'available'\n  });\n\n  self.getContext = function() {\n    return {\n        id: self.id,\n        type: self.type,\n        handle: self.handle\n    };\n  };\n\n  self.clear = function () {\n    self.fetchedOnce(false);\n    self.hasMore(false);\n    self.statement_range({\n      start: {\n        row: 0,\n        column: 0\n      },\n      end: {\n        row: 0,\n        column: 0\n      }\n    });\n    self.meta.removeAll();\n    self.data.removeAll();\n    self.images.removeAll();\n    self.logs('');\n    self.handle({ // Keep multiquery indexing\n        has_more_statements: self.handle()['has_more_statements'],\n        statement_id: self.handle()['statement_id'],\n        statements_count: self.handle()['statements_count'],\n        previous_statement_hash: self.handle()['previous_statement_hash'],\n    });\n    self.startTime(new Date());\n    self.endTime(new Date());\n    self.explanation('');\n    self.logLines = 0;\n    self.rows(null);\n  };\n};\n\nResult.prototype.cancelBatchExecution = function () {\n  let self = this;\n  self.statements_count(1);\n  self.hasMore(false);\n  self.statement_range({\n    start: {\n      row: 0,\n      column: 0\n    },\n    end: {\n      row: 0,\n      column: 0\n    }\n  });\n  self.handle()['statement_id'] = 0;\n  self.handle()['start'] = {\n    row: 0,\n    column: 0\n  };\n  self.handle()['end'] = {\n    row: 0,\n    column: 0\n  };\n  self.handle()['has_more_statements'] = false;\n  self.handle()['previous_statement_hash'] = '';\n};\n\nlet getDefaultSnippetProperties = function (snippetType) {\n  let properties = {};\n\n  if (snippetType == 'jar' || snippetType == 'py') {\n    properties['driverCores'] = '';\n    properties['executorCores'] = '';\n    properties['numExecutors'] = '';\n    properties['queue'] = '';\n    properties['archives'] = [];\n    properties['files'] = [];\n  }\n\n  if (snippetType == 'java') {\n    properties['archives'] = [];\n    properties['files'] = [];\n    properties['capture_output'] = false;\n  }\n\n  if (snippetType == 'shell') {\n    properties['archives'] = [];\n    properties['files'] = [];\n  }\n\n  if (snippetType == 'mapreduce') {\n    properties['app_jar'] = '';\n    properties['hadoopProperties'] = [];\n    properties['jars'] = [];\n    properties['files'] = [];\n    properties['archives'] = [];\n  }\n\n  if (snippetType == 'spark2') {\n    properties['app_name'] = '';\n    properties['class'] = '';\n    properties['jars'] = [];\n    properties['spark_opts'] = [];\n    properties['spark_arguments'] = [];\n    properties['files'] = [];\n  }\n\n  if (snippetType == 'sqoop1') {\n    properties['files'] = [];\n  }\n\n  if (snippetType == 'jar' || snippetType == 'java') {\n    properties['app_jar'] = '';\n    properties['class'] = '';\n    properties['arguments'] = [];\n  } else if (snippetType == 'distcp') {\n    properties['source_path'] = '';\n    properties['destination_path'] = '';\n  } else if (snippetType == 'shell') {\n    properties['command_path'] = '';\n    properties['arguments'] = [];\n    properties['env_var'] = [];\n    properties['capture_output'] = true;\n  } else if (snippetType == 'py') {\n    properties['py_file'] = '';\n    properties['arguments'] = [];\n  } else if (snippetType == 'hive') {\n    properties['settings'] = [];\n    properties['files'] = [];\n    properties['functions'] = [];\n    properties['arguments'] = [];\n  } else if (snippetType == 'impala') {\n    properties['settings'] = [];\n  } else if (snippetType == 'pig') {\n    properties['parameters'] = [];\n    properties['hadoopProperties'] = [];\n    properties['resources'] = [];\n  }\n\n  return properties;\n};\n\nlet ERROR_REGEX = /line ([0-9]+)(\\:([0-9]+))?/i;\n\nlet Snippet = function (vm, notebook, snippet) {\n  let self = this;\n\n  self.id = ko.observable(typeof snippet.id != \"undefined\" && snippet.id != null ? snippet.id : hueUtils.UUID());\n  self.name = ko.observable(typeof snippet.name != \"undefined\" && snippet.name != null ? snippet.name : '');\n  self.type = ko.observable(typeof snippet.type != \"undefined\" && snippet.type != null ? snippet.type : 'hive');\n  self.type.subscribe(function(newVal) {\n    self.status('ready');\n  });\n\n  self.isBatchable = ko.computed(function() {\n    return self.type() == 'hive'\n        || self.type() == 'impala'\n        || $.grep(vm.availableLanguages, function(language) { return language.type == self.type() && language.interface == 'oozie'; }).length > 0;\n  });\n\n  self.autocompleteSettings = {\n    temporaryOnly: false\n  };\n\n  // Ace stuff\n  self.aceCursorPosition = ko.observable(notebook.isHistory() ? snippet.aceCursorPosition : null);\n\n  let aceEditor = null;\n\n  self.ace = function (newVal) {\n    if (newVal) {\n      aceEditor = newVal;\n      if (!notebook.isPresentationMode()) {\n        aceEditor.focus();\n      }\n    }\n    return aceEditor\n  };\n  self.errors = ko.observableArray([]);\n\n  self.aceErrorsHolder = ko.observableArray([]);\n  self.aceWarningsHolder = ko.observableArray([]);\n\n  self.aceErrors = ko.pureComputed(function(){\n    return self.showOptimizer() ? self.aceErrorsHolder() : [];\n  });\n  self.aceWarnings = ko.pureComputed(function(){\n    return self.showOptimizer() ? self.aceWarningsHolder() : [];\n  });\n\n  self.availableSnippets = vm.availableSnippets();\n  self.inFocus = ko.observable(false);\n\n  self.inFocus.subscribe(function (newValue) {\n    if (newValue) {\n      huePubSub.publish('active.snippet.type.changed', self.type());\n    }\n  });\n\n  self.editorMode = vm.editorMode;\n\n  self.getAceMode = function() {\n    return vm.getSnippetViewSettings(self.type()).aceMode;\n  };\n\n  self.dbSelectionVisible = ko.observable(false);\n\n  self.showExecutionAnalysis = ko.observable(false);\n\n  self.isSqlDialect = ko.pureComputed(function () {\n    return vm.getSnippetViewSettings(self.type()).sqlDialect;\n  });\n\n  self.getPlaceHolder = function() {\n    return vm.getSnippetViewSettings(self.type()).placeHolder;\n  };\n\n  self.getApiHelper = function() {\n    return apiHelper;\n  };\n\n  // namespace and compute might be initialized as empty object {}\n  self.namespace = ko.observable(snippet.namespace && snippet.namespace.id ? snippet.namespace : undefined);\n  self.compute = ko.observable(snippet.compute && snippet.compute.id ? snippet.compute : undefined);\n\n  self.whenContextSet = function () {\n    let namespaceSub;\n    let namespaceDeferred = $.Deferred();\n    if (self.namespace()) {\n      namespaceDeferred.resolve(self.namespace());\n    } else {\n      namespaceSub = self.namespace.subscribe(function (newVal) {\n        if (newVal) {\n          namespaceDeferred.resolve(newVal);\n          namespaceSub.dispose();\n        }\n      })\n    }\n    let computeSub;\n    let computeDeferred = $.Deferred();\n    if (self.compute()) {\n      computeDeferred.resolve(self.compute());\n    } else {\n      computeSub = self.compute.subscribe(function (newVal) {\n        if (newVal) {\n          computeDeferred.resolve(newVal);\n          computeSub.dispose();\n        }\n      })\n    }\n\n    let result = $.when(namespaceDeferred, computeDeferred);\n\n    result.dispose = function () {\n      if (namespaceSub) {\n        namespaceSub.dispose();\n      }\n      if (computeSub) {\n        computeSub.dispose();\n      }\n      namespaceDeferred.reject();\n      computeDeferred.reject();\n    };\n\n    return result;\n  };\n\n  self.availableDatabases = ko.observableArray();\n  self.database = ko.observable();\n  let previousDatabase = null;\n\n  self.database.subscribe(function (newValue) {\n    if (newValue !== null) {\n      apiHelper.setInTotalStorage('editor', 'last.selected.database', newValue);\n      if (previousDatabase !== null && previousDatabase !== newValue) {\n        huePubSub.publish('editor.refresh.statement.locations', self);\n      }\n      previousDatabase = newValue;\n    }\n  });\n\n  self.database(typeof snippet.database !== \"undefined\" && snippet.database != null ? snippet.database : null);\n\n  // History is currently in Notebook, same with saved queries by snippets, might be better in assist\n  self.currentQueryTab = ko.observable(typeof snippet.currentQueryTab != \"undefined\" && snippet.currentQueryTab != null ? snippet.currentQueryTab : 'queryHistory');\n  self.pinnedContextTabs = ko.observableArray(typeof snippet.pinnedContextTabs != \"undefined\" && snippet.pinnedContextTabs != null ? snippet.pinnedContextTabs : []);\n\n  self.removeContextTab = function (context) {\n    if (context.tabId === self.currentQueryTab()) {\n      self.currentQueryTab('queryHistory');\n    }\n    self.pinnedContextTabs.remove(context);\n  };\n\n  self.errorLoadingQueries = ko.observable(false);\n  self.loadingQueries = ko.observable(false);\n\n  self.queriesHasErrors = ko.observable(false);\n  self.queriesCurrentPage = ko.observable(vm.selectedNotebook() && vm.selectedNotebook().snippets().length > 0 ? vm.selectedNotebook().snippets()[0].queriesCurrentPage() : 1);\n  self.queriesTotalPages = ko.observable(vm.selectedNotebook() && vm.selectedNotebook().snippets().length > 0 ? vm.selectedNotebook().snippets()[0].queriesTotalPages() : 1);\n  self.queries = ko.observableArray([]);\n\n  self.queriesFilter = ko.observable('');\n  self.queriesFilterVisible = ko.observable(false);\n  self.queriesFilter.extend({ rateLimit: { method: \"notifyWhenChangesStop\", timeout: 900 } });\n  self.queriesFilter.subscribe(function(val){\n    self.fetchQueries();\n  });\n\n  let lastFetchQueriesRequest = null;\n\n  self.fetchQueries = function () {\n    apiHelper.cancelActiveRequest(lastFetchQueriesRequest);\n\n    let QUERIES_PER_PAGE = 50;\n    lastQueriesPage = self.queriesCurrentPage();\n    self.loadingQueries(true);\n    self.queriesHasErrors(false);\n    lastFetchQueriesRequest = apiHelper.searchDocuments({\n      successCallback: function (result) {\n        self.queriesTotalPages(Math.ceil(result.count / QUERIES_PER_PAGE));\n        self.queries(komapping.fromJS(result.documents)());\n        self.loadingQueries(false);\n        self.queriesHasErrors(false);\n      },\n      errorCallback: function () {\n        self.loadingQueries(false);\n        self.queriesHasErrors(true);\n      },\n      page: self.queriesCurrentPage(),\n      limit: QUERIES_PER_PAGE,\n      type: 'query-' + self.type(),\n      query: self.queriesFilter(),\n      include_trashed: false\n    });\n  };\n\n  let lastQueriesPage = 1;\n  self.currentQueryTab.subscribe(function (newValue) {\n    huePubSub.publish('redraw.fixed.headers');\n    huePubSub.publish('tab.switched', newValue);\n    if (newValue === 'savedQueries' && (self.queries().length === 0 || lastQueriesPage !== self.queriesCurrentPage())) {\n      self.fetchQueries();\n    }\n  });\n\n  self.prevQueriesPage = function () {\n    if (self.queriesCurrentPage() !== 1) {\n      self.queriesCurrentPage(self.queriesCurrentPage() - 1);\n      self.fetchQueries();\n    }\n  };\n\n  self.nextQueriesPage = function () {\n    if (self.queriesCurrentPage() !== self.queriesTotalPages()) {\n      self.queriesCurrentPage(self.queriesCurrentPage() + 1);\n      self.fetchQueries();\n    }\n  };\n\n  huePubSub.subscribeOnce('assist.source.set', function (source) {\n    if (source !== self.type()) {\n      huePubSub.publish('assist.set.source', self.type());\n    }\n  }, vm.huePubSubId);\n\n  huePubSub.publish('assist.get.source');\n\n  let ignoreNextAssistDatabaseUpdate = false;\n  self.handleAssistSelection = function (databaseDef) {\n    if (ignoreNextAssistDatabaseUpdate) {\n      ignoreNextAssistDatabaseUpdate = false;\n    } else if (databaseDef.sourceType === self.type()) {\n      if (self.namespace() !== databaseDef.namespace) {\n        self.namespace(databaseDef.namespace)\n      }\n      if (self.database() !== databaseDef.name) {\n        self.database(databaseDef.name);\n      }\n    }\n  };\n\n  if (!self.database()) {\n    huePubSub.publish('assist.get.database.callback', { source: self.type(), callback: function (databaseDef) {\n      self.handleAssistSelection(databaseDef);\n    }});\n  }\n\n  self.statementType = ko.observable(typeof snippet.statementType != \"undefined\" && snippet.statementType != null ? snippet.statementType : 'text');\n  self.statementTypes = ko.observableArray(['text', 'file']); // Maybe computed later for Spark\n  if (! vm.editorMode()) {\n    self.statementTypes.push('document');\n  }\n  self.statementPath = ko.observable(typeof snippet.statementPath != \"undefined\" && snippet.statementPath != null ? snippet.statementPath : '');\n  self.statementPath.subscribe(function(newVal) {\n    self.getExternalStatement();\n  });\n  self.externalStatementLoaded = ko.observable(false);\n  self.getExternalStatement = function() {\n    self.externalStatementLoaded(false);\n    $.post(\"/notebook/api/get_external_statement\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function(data) {\n      if (data.status == 0) {\n        self.externalStatementLoaded(true);\n        self.statement_raw(data.statement);\n        self.ace().setValue(self.statement_raw(), 1);\n      } else {\n        self._ajaxError(data);\n      }\n    });\n  };\n  self.associatedDocumentLoading = ko.observable(true);\n  self.associatedDocument = ko.observable();\n  self.associatedDocumentUuid = ko.observable(typeof snippet.associatedDocumentUuid != \"undefined\" && snippet.associatedDocumentUuid != null ? snippet.associatedDocumentUuid : null);\n  self.associatedDocumentUuid.subscribe(function(val){\n    if (val !== ''){\n      self.getExternalStatement();\n    }\n    else {\n      self.statement_raw('');\n      self.ace().setValue('', 1);\n    }\n  });\n  self.statement_raw = ko.observable(typeof snippet.statement_raw != \"undefined\" && snippet.statement_raw != null ? snippet.statement_raw : '');\n  self.selectedStatement = ko.observable('');\n  self.positionStatement = ko.observable(null);\n  self.lastExecutedStatement = ko.observable(null);\n  self.statementsList = ko.observableArray();\n\n  huePubSub.subscribe('editor.active.statement.changed', function (statementDetails) {\n    if (self.ace() && self.ace().container.id === statementDetails.id) {\n      if (statementDetails.activeStatement) {\n        self.positionStatement(statementDetails.activeStatement);\n      } else {\n        self.positionStatement(null);\n      }\n\n      if (statementDetails.activeStatement) {\n        let _statements = [];\n         statementDetails.precedingStatements.forEach(function (statement) {\n           _statements.push(statement.statement);\n         });\n         _statements.push(statementDetails.activeStatement.statement);\n         statementDetails.followingStatements.forEach(function (statement) {\n           _statements.push(statement.statement);\n        });\n        self.statementsList(_statements); // Or fetch on demand via editor.refresh.statement.locations and remove observableArray?\n      } else {\n        self.statementsList([]);\n      }\n      if (!notebook.isPresentationModeInitialized()) {\n        if (notebook.isPresentationModeDefault()) {\n          // When switching to presentation mode, the snippet in non presentation mode cannot get status notification.\n          // On initiailization, status is set to loading and does not get updated, because we moved to presentation mode.\n          self.status('ready');\n        }\n        // Changing to presentation mode requires statementsList to be initialized. statementsList is initialized asynchronously.\n        // When presentation mode is default, we cannot change before statementsList has been calculated.\n        // Cleaner implementation would be to make toggleEditorMode statementsList asynchronous\n        // However this is currently impossible due to delete _notebook.presentationSnippets()[key];\n        notebook.isPresentationModeInitialized(true);\n        notebook.isPresentationMode(notebook.isPresentationModeDefault());\n      }\n    }\n\n  }, vm.huePubSubId);\n\n  self.aceSize = ko.observable(typeof snippet.aceSize != \"undefined\" && snippet.aceSize != null ? snippet.aceSize : 100);\n  // self.statement_raw.extend({ rateLimit: 150 }); // Should prevent lag from typing but currently send the old query when using the key shortcut\n  self.status = ko.observable(typeof snippet.status != \"undefined\" && snippet.status != null ? snippet.status : 'loading');\n  self.statusForButtons = ko.observable('executed');\n\n  self.properties = ko.observable(komapping.fromJS(typeof snippet.properties != \"undefined\" && snippet.properties != null ? snippet.properties : getDefaultSnippetProperties(self.type())));\n  self.hasProperties = ko.computed(function() {\n    return Object.keys(komapping.toJS(self.properties())).length > 0;\n  });\n\n  self.viewSettings = ko.computed(function() {\n    return vm.getSnippetViewSettings(self.type());\n  });\n\n  let previousProperties = {};\n  self.type.subscribe(function(oldValue) {\n    previousProperties[oldValue] = self.properties();\n  }, null, \"beforeChange\");\n\n  self.type.subscribe(function (newValue) {\n    if (typeof previousProperties[newValue] != \"undefined\") {\n      self.properties(previousProperties[newValue]);\n    } else {\n      self.properties(komapping.fromJS(getDefaultSnippetProperties(newValue)));\n    }\n    self.result.clear();\n    window.setTimeout(function () {\n      if (self.ace() !== null) {\n        self.ace().focus();\n      }\n    }, 100);\n  });\n  if (snippet.variables) {\n    snippet.variables.forEach(function (variable) {\n      variable.meta = (typeof variable.defaultValue === \"object\" && variable.defaultValue) || {type: \"text\", placeholder: \"\"};\n      variable.value = variable.value || '';\n      variable.type = variable.type || 'text';\n      variable.sample = [];\n      variable.sampleUser = variable.sampleUser || [];\n      variable.path = variable.path || '';\n      variable.step = '';\n      delete variable.defaultValue;\n    });\n  }\n  self.variables = komapping.fromJS(typeof snippet.variables != \"undefined\" && snippet.variables != null ? snippet.variables : []);\n  self.variables.subscribe(function (newValue) {\n    $(document).trigger(\"updateResultHeaders\", self);\n  });\n  self.hasCurlyBracketParameters = ko.computed(function() {\n    return self.type() != 'pig';\n  });\n  self.getPigParameters = function() {\n    let params = {};\n    let variables = self.statement_raw().match(/([^\\\\]|^)\\$[^\\d'\"](\\w*)/g);\n    let declares = self.statement_raw().match(/%declare +([^ ])+/gi);\n    let defaults = self.statement_raw().match(/%default +([^;])+/gi);\n    let macro_defines = self.statement_raw().match(/define [^ ]+ *\\(([^\\)]*)\\)/gi); // no multiline\n    let macro_returns = self.statement_raw().match(/returns +([^\\{]*)/gi); // no multiline\n\n    if (variables) {\n      $.each(variables, function(index, param) {\n        let p = param.substring(param.indexOf('$') + 1);\n        params[p] = '';\n      });\n    }\n    if (declares) {\n      $.each(declares, function(index, param) {\n        param = param.match(/(\\w+)/g);\n        if (param && param.length >= 2) {\n          delete params[param[1]];\n        }\n      });\n    }\n    if (defaults) {\n      $.each(defaults, function(index, param) {\n        let line = param.match(/(\\w+)/g);\n        if (line && line.length >= 2) {\n          let name = line[1];\n          params[name] = param.substring(param.indexOf(name) + name.length + 1);\n        }\n      });\n    }\n    if (macro_defines) {\n      $.each(macro_defines, function(index, params_line) {\n        let param_line = params_line.match(/(\\w+)/g);\n        if (param_line && param_line.length > 2) {\n          $.each(param_line, function(index, param) {\n            if (index >= 2) { // Skips define NAME\n              delete params[param];\n            }\n          });\n        }\n      });\n    }\n    if (macro_returns) {\n      $.each(macro_returns, function(index, params_line) {\n        let param_line = params_line.match(/(\\w+)/g);\n        if (param_line) {\n          $.each(param_line, function(index, param) {\n            if (index >= 1) { // Skip returns\n              delete params[param];\n            }\n          });\n        }\n      });\n    }\n\n    return params;\n  };\n  self.variableNames = ko.computed(function () {\n    let match, matches = {}, matchList;\n    if (self.type() == 'pig') {\n      matches = self.getPigParameters();\n    } else {\n      let re = /(?:^|\\W)\\${(\\w*)\\=?([^{}]*)}/g;\n      let reComment = /(^\\s*--.*)|(\\/\\*[\\s\\S]*?\\*\\/)/gm;\n      let reList = /(?!\\s*$)\\s*(?:(?:([^,|()\\\\]*)\\(\\s*([^,|()\\\\]*)\\)(?:\\\\[\\S\\s][^,|()\\\\]*)?)|([^,|\\\\]*(?:\\\\[\\S\\s][^,|\\\\]*)*))\\s*(?:,|\\||$)/g\n      let statement = self.statement_raw();\n      let matchComment = reComment.exec(statement);\n      // if re is n & reComment is m\n      // finding variables is O(n+m)\n      while (match = re.exec(statement)) {\n        while (matchComment && match.index > matchComment.index + matchComment[0].length) { // Comments before our match\n          matchComment = reComment.exec(statement);\n        }\n        let isWithinComment = matchComment && match.index >= matchComment.index;\n        if (isWithinComment) continue;\n\n        // If 1 match, text value\n        // If multiple matches, list value\n        let value = { type: 'text', placeholder: '' };\n        while (matchList = reList.exec(match[2])) {\n          let option = {text:matchList[2] || matchList[3], value:matchList[3] || matchList[1]};\n          option.text = option.text && option.text.trim();\n          option.value = option.value && option.value.trim().replace('\\,', ',').replace('\\(', '(').replace('\\)', ')');\n\n          if (value.placeholder || matchList[2]) {\n            if (!value.options) {\n              value.options = [];\n              value.type = 'select';\n            }\n            value.options.push(option);\n          }\n          if (!value.placeholder) value.placeholder = option.value;\n        }\n        let isPlaceholderInOptions = !value.options || value.options.some(function (current){\n          return current.value == value.placeholder;\n        });\n        if (!isPlaceholderInOptions) {\n          value.options.unshift({ text: value.placeholder, value: value.placeholder });\n        }\n        matches[match[1]] = matches[match[1]] || value;\n      }\n    }\n    return $.map(matches, function (match, key) {\n      let isMatchObject = typeof matches[key] === 'object';\n      let meta = isMatchObject ? matches[key] : { type: 'text', placeholder: matches[key] };\n      return { name: key, meta: meta };\n    });\n  });\n  self.variableValues = {};\n  self.variableNames.extend({ rateLimit: 150 });\n  self.variableNames.subscribe(function (newVal) {\n    let variablesLength = self.variables().length;\n    let diffLengthVariables = variablesLength - newVal.length;\n    let needsMore = diffLengthVariables < 0;\n    let needsLess = diffLengthVariables > 0;\n    self.variableValues = self.variables().reduce(function (variableValues, variable) {\n      if (!variableValues[variable.name()]) {\n        variableValues[variable.name()] = { sampleUser: [] };\n      }\n      variableValues[variable.name()].value = variable.value();\n      variableValues[variable.name()].sampleUser = variable.sampleUser();\n      variableValues[variable.name()].catalogEntry = variable.catalogEntry;\n      variableValues[variable.name()].path = variable.path();\n      variableValues[variable.name()].type = variable.type();\n      return variableValues;\n    }, self.variableValues);\n    if (needsMore) {\n      for (let i = 0, length = Math.abs(diffLengthVariables); i < length; i++) {\n        self.variables.push(komapping.fromJS({ name: '', value: '', meta: { type: 'text', placeholder: '', options: [] }, sample: [], sampleUser: [], type: 'text', step: '', path: ''}));\n      }\n    } else if (needsLess) {\n      self.variables.splice(self.variables().length - diffLengthVariables, diffLengthVariables);\n    }\n    newVal.forEach(function (item, index) {\n      let variable = self.variables()[index];\n      variable.name(item.name);\n      setTimeout(function(){\n        variable.value(self.variableValues[item.name] ? self.variableValues[item.name].value : (!needsMore && variable.value()) || '');\n      },0);\n      variable.meta = komapping.fromJS(item.meta, {}, variable.meta);\n      variable.sample(variable.meta.options ? variable.meta.options().concat(variable.sampleUser()) : variable.sampleUser())\n      variable.sampleUser(self.variableValues[item.name] ? self.variableValues[item.name].sampleUser : []);\n      variable.type(self.variableValues[item.name] ? self.variableValues[item.name].type || 'text' : 'text');\n      variable.path(self.variableValues[item.name] ? self.variableValues[item.name].path || '' : '');\n      variable.catalogEntry = self.variableValues[item.name] && self.variableValues[item.name].catalogEntry;\n    });\n  });\n\n  let activeSourcePromises = [];\n  huePubSub.subscribe('ace.sql.location.worker.message', function (e) {\n    while (activeSourcePromises.length) {\n      let promise = activeSourcePromises.pop();\n      if (promise.cancel) {\n        promise.cancel();\n      }\n    }\n    let sourceType = self.type();\n    let oLocations = e.data.locations\n    .filter(function (location) {\n      return location.type === 'variable' && location.colRef;\n    })\n    .reduce(function (variables, location) {\n      let re = /\\${(\\w*)\\=?([^{}]*)}/g;\n      let name = re.exec(location.value)[1];\n      variables[name] = location;\n      return variables;\n    }, {});\n    let updateVariableType = function (variable, sourceMeta) {\n      let type;\n      if (sourceMeta && sourceMeta.type) {\n        type = sourceMeta.type.toLowerCase();\n      } else {\n        type = 'string';\n      }\n      let variablesValues = {};\n      let value = variable.value();\n      switch (type) {\n        case 'timestamp':\n          variablesValues.type = 'datetime-local';\n          variablesValues.step = '1';\n          variablesValues.value = value && moment.utc(value).format(\"YYYY-MM-DD HH:mm:ss.S\") || moment(Date.now()).format(\"YYYY-MM-DD 00:00:00.0\");\n          break;\n        case 'decimal':\n        case 'double':\n        case 'float':\n          variablesValues.type = 'number';\n          variablesValues.step = 'any';\n          break;\n        case 'int':\n        case 'smallint':\n        case 'tinyint':\n        case 'bigint':\n          variablesValues.type = 'number';\n          variablesValues.step = '1';\n          break;\n        case 'date':\n          variablesValues.type = 'date';\n          variablesValues.step = '';\n          variablesValues.value = value && moment.utc(value).format(\"YYYY-MM-DD\") || moment(Date.now()).format(\"YYYY-MM-DD\");\n          break;\n        case 'boolean':\n          variablesValues.type = 'checkbox';\n          variablesValues.step = '';\n          break;\n        default:\n          variablesValues.type = 'text';\n          variablesValues.step = '';\n      }\n      if (variablesValues.value) {\n        setTimeout(function () {\n          variable.value(variablesValues.value);\n        }, 0);\n      }\n      variable.type(variablesValues.type);\n      variable.step(variablesValues.step);\n    };\n    self.variables().forEach(function (variable) {\n      if (oLocations[variable.name()]) {\n        activeSourcePromises.push(oLocations[variable.name()].resolveCatalogEntry({ cancellable: true }).done(function (entry) {\n          variable.path(entry.path.join('.'));\n          variable.catalogEntry = entry;\n\n          activeSourcePromises.push(entry.getSourceMeta({\n            silenceErrors: true,\n            cancellable: true\n          }).then(updateVariableType.bind(self, variable)));\n        }));\n      } else {\n        updateVariableType(variable, {\n          type: 'text'\n        });\n      }\n    });\n  });\n  self.statement = ko.computed(function () {\n    let statement = self.isSqlDialect() ? (self.selectedStatement() ? self.selectedStatement() : (self.positionStatement() !== null ? self.positionStatement().statement : self.statement_raw())) : self.statement_raw();\n    let variables = self.variables().reduce(function (variables, variable) {\n      variables[variable.name()] = variable;\n      return variables;\n    }, {});\n    if (self.variables().length) {\n      let variablesString = self.variables().map(function(variable) { return variable.name(); }).join(\"|\");\n      statement = statement.replace(RegExp(\"([^\\\\\\\\])?\\\\$\" + (self.hasCurlyBracketParameters() ? \"{(\" : \"(\") + variablesString + \")(=[^}]*)?\" + (self.hasCurlyBracketParameters() ? \"}\" : \"\"), \"g\"), function(match, p1, p2){\n        let variable = variables[p2];\n        let pad = variable.type() == 'datetime-local' && variable.value().length == 16 ? ':00' : ''; // Chrome drops the seconds from the timestamp when it's at 0 second.\n        let value = variable.value();\n        return p1 + (value !== undefined && value !== null ? value + pad : variable.meta.placeholder && variable.meta.placeholder());\n      });\n    }\n    return statement;\n  });\n\n  self.result = new Result(snippet, snippet.result);\n  if (! self.result.hasSomeResults()) {\n    self.currentQueryTab('queryHistory');\n  }\n  self.showGrid = ko.observable(typeof snippet.showGrid != \"undefined\" && snippet.showGrid != null ? snippet.showGrid : true);\n  self.showChart = ko.observable(typeof snippet.showChart != \"undefined\" && snippet.showChart != null ? snippet.showChart : false);\n  let defaultShowLogs = true;\n  if (vm.editorMode() && $.totalStorage('hue.editor.showLogs')) {\n    defaultShowLogs = $.totalStorage('hue.editor.showLogs');\n  }\n  self.showLogs = ko.observable(typeof snippet.showLogs !== \"undefined\" && snippet.showLogs != null ? snippet.showLogs : defaultShowLogs);\n  self.progress = ko.observable(typeof snippet.progress !== \"undefined\" && snippet.progress != null ? snippet.progress : 0);\n  self.jobs = ko.observableArray(typeof snippet.jobs !== \"undefined\" && snippet.jobs != null ? snippet.jobs : []);\n\n  self.executeNextTimeout = -1;\n  let refreshTimeouts = {};\n  self.onDdlExecute = function () {\n    if (self.result.handle() && self.result.handle().has_more_statements) {\n      window.clearTimeout(self.executeNextTimeout);\n      self.executeNextTimeout = setTimeout(function () {\n        self.execute(true); // Execute next, need to wait as we disabled fast click\n      }, 1000);\n    }\n    if (self.lastExecutedStatement() && /CREATE|DROP/i.test(self.lastExecutedStatement().firstToken)) {\n      let match = self.statement().match(/(?:CREATE|DROP)\\s+TABLE\\s+(?:IF\\s+(?:NOT\\s+)?EXISTS\\s+)?(?:`([^`]+)`|([^;\\s]+))\\..*/i);\n      let path = [];\n      if (match) {\n        path.push(match[1] || match[2]); // group 1 backticked db name, group 2 regular db name\n      } else {\n        match = self.statement().match(/(?:CREATE|DROP)\\s+(?:DATABASE|SCHEMA)\\s+(?:IF\\s+(?:NOT\\s+)?EXISTS\\s+)?(?:`([^`]+)`|([^;\\s]+))/i);\n        if (match) {\n          path.push(match[1] || match[2]); // group 1 backticked db name, group 2 regular db name\n        } else if (self.database()) {\n          path.push(self.database());\n        }\n      }\n\n      if (path.length) {\n        window.clearTimeout(refreshTimeouts[path.join('.')]);\n        refreshTimeouts[path.join('.')] = window.setTimeout(function () {\n          ignoreNextAssistDatabaseUpdate = true;\n          dataCatalog.getEntry({ sourceType: self.type(), namespace: self.namespace(), compute: self.compute(), path: path }).done(function (entry) {\n            entry.clearCache({ invalidate: 'invalidate', cascade: true, silenceErrors: true });\n          });\n        }, 5000);\n      }\n    }\n  };\n\n  self.progress.subscribe(function (val) {\n    $(document).trigger(\"progress\", {data: val, snippet: self});\n  });\n\n  self.showGrid.subscribe(function (val) {\n    if (val) {\n      self.showChart(false);\n      huePubSub.publish('editor.grid.shown', self);\n    }\n  });\n\n  function prepopulateChart() {\n    let type = self.chartType();\n    hueAnalytics.log('notebook', 'chart/' + type);\n\n    if (type === ko.HUE_CHARTS.TYPES.MAP && self.result.cleanedNumericMeta().length >= 2) {\n      if ((self.chartX() === null || typeof self.chartX() === 'undefined')) {\n        let name = self.result.cleanedNumericMeta()[0].name;\n        self.result.cleanedNumericMeta().forEach(function (fld) {\n          if (fld.name.toLowerCase().indexOf('lat') > -1 || fld.name.toLowerCase().indexOf('ltd') > -1) {\n            name = fld.name;\n          }\n        });\n        self.chartX(name);\n      }\n      if ((self.chartYSingle() === null || typeof self.chartYSingle() === 'undefined')) {\n        let name = self.result.cleanedNumericMeta()[1].name;\n        self.result.cleanedNumericMeta().forEach(function (fld) {\n          if (fld.name.toLowerCase().indexOf('lon') > -1 || fld.name.toLowerCase().indexOf('lng') > -1) {\n            name = fld.name;\n          }\n        });\n        self.chartYSingle(name);\n      }\n      return;\n    }\n\n    if ((self.chartX() === null || typeof self.chartX() === 'undefined') && (type == ko.HUE_CHARTS.TYPES.BARCHART || type == ko.HUE_CHARTS.TYPES.PIECHART || type == ko.HUE_CHARTS.TYPES.GRADIENTMAP) && self.result.cleanedStringMeta().length >= 1) {\n      self.chartX(self.result.cleanedStringMeta()[0].name);\n    }\n\n    if (self.result.cleanedNumericMeta().length > 0) {\n      if (self.chartYMulti().length === 0 && (type === ko.HUE_CHARTS.TYPES.BARCHART || type === ko.HUE_CHARTS.TYPES.LINECHART)) {\n        self.chartYMulti.push(self.result.cleanedNumericMeta()[Math.min(self.result.cleanedNumericMeta().length - 1, 1)].name);\n      } else if ((self.chartYSingle() === null || typeof self.chartYSingle() === 'undefined') && (type === ko.HUE_CHARTS.TYPES.PIECHART || type === ko.HUE_CHARTS.TYPES.MAP || type === ko.HUE_CHARTS.TYPES.GRADIENTMAP || type === ko.HUE_CHARTS.TYPES.SCATTERCHART || (type === ko.HUE_CHARTS.TYPES.BARCHART && self.chartXPivot() !== null))) {\n        if (self.chartYMulti().length === 0) {\n          self.chartYSingle(self.result.cleanedNumericMeta()[Math.min(self.result.cleanedNumericMeta().length - 1, 1)].name);\n        }\n        else {\n          self.chartYSingle(self.chartYMulti()[0]);\n        }\n      }\n    }\n  }\n\n  self.showChart.subscribe(function (val) {\n    if (val) {\n      self.showGrid(false);\n      self.isResultSettingsVisible(true);\n      $(document).trigger(\"forceChartDraw\", self);\n      huePubSub.publish('editor.chart.shown', self);\n      prepopulateChart();\n    }\n  });\n  self.showLogs.subscribe(function (val) {\n    huePubSub.publish('redraw.fixed.headers');\n    if (val) {\n      self.getLogs();\n    }\n    if (vm.editorMode()) {\n      $.totalStorage('hue.editor.showLogs', val);\n    }\n  });\n\n  self.isLoading = ko.computed(function () {\n    return self.status() == \"loading\";\n  });\n\n  self.resultsKlass = ko.computed(function () {\n    return \"results \" + self.type();\n  });\n\n  self.errorsKlass = ko.computed(function () {\n    return self.resultsKlass() + \" alert alert-error\";\n  });\n\n  self.is_redacted = ko.observable(typeof snippet.is_redacted != \"undefined\" && snippet.is_redacted != null ? snippet.is_redacted : false);\n\n  self.chartType = ko.observable(typeof snippet.chartType != \"undefined\" && snippet.chartType != null ? snippet.chartType : ko.HUE_CHARTS.TYPES.BARCHART);\n  self.chartType.subscribe(prepopulateChart);\n  self.chartSorting = ko.observable(typeof snippet.chartSorting != \"undefined\" && snippet.chartSorting != null ? snippet.chartSorting : \"none\");\n  self.chartScatterGroup = ko.observable(typeof snippet.chartScatterGroup != \"undefined\" && snippet.chartScatterGroup != null ? snippet.chartScatterGroup : null);\n  self.chartScatterSize = ko.observable(typeof snippet.chartScatterSize != \"undefined\" && snippet.chartScatterSize != null ? snippet.chartScatterSize : null);\n  self.chartScope = ko.observable(typeof snippet.chartScope != \"undefined\" && snippet.chartScope != null ? snippet.chartScope : \"world\");\n  self.chartTimelineType = ko.observable(typeof snippet.chartTimelineType != \"undefined\" && snippet.chartTimelineType != null ? snippet.chartTimelineType : \"bar\");\n  self.chartLimits = ko.observableArray([5, 10, 25, 50, 100]);\n  self.chartLimit = ko.observable(typeof snippet.chartLimit != \"undefined\" && snippet.chartLimit != null ? snippet.chartLimit : null);\n  self.chartLimit.extend({notify: 'always'});\n  self.chartX = ko.observable(typeof snippet.chartX != \"undefined\" && snippet.chartX != null ? snippet.chartX : null);\n  self.chartX.extend({notify: 'always'});\n  self.chartXPivot = ko.observable(typeof snippet.chartXPivot != \"undefined\" && snippet.chartXPivot != null ? snippet.chartXPivot : null);\n  self.chartXPivot.extend({notify: 'always'});\n  self.chartXPivot.subscribe(prepopulateChart);\n  self.chartYSingle = ko.observable(typeof snippet.chartYSingle != \"undefined\" && snippet.chartYSingle != null ? snippet.chartYSingle : null);\n  self.chartYMulti = ko.observableArray(typeof snippet.chartYMulti != \"undefined\" && snippet.chartYMulti != null ? snippet.chartYMulti : []);\n  self.chartData = ko.observableArray(typeof snippet.chartData != \"undefined\" && snippet.chartData != null ? snippet.chartData : []);\n  self.chartMapType = ko.observable(typeof snippet.chartMapType != \"undefined\" && snippet.chartMapType != null ? snippet.chartMapType : 'marker');\n  self.chartMapLabel = ko.observable(typeof snippet.chartMapLabel != \"undefined\" && snippet.chartMapLabel != null ? snippet.chartMapLabel : null);\n  self.chartMapHeat = ko.observable(typeof snippet.chartMapHeat != \"undefined\" && snippet.chartMapHeat != null ? snippet.chartMapHeat : null);\n  self.hideStacked = ko.computed(function() {\n    return self.chartYMulti().length <= 1;\n  });\n\n  self.hasDataForChart = ko.computed(function () {\n    if (self.chartType() == ko.HUE_CHARTS.TYPES.BARCHART || self.chartType() == ko.HUE_CHARTS.TYPES.LINECHART || self.chartType() == ko.HUE_CHARTS.TYPES.TIMELINECHART) {\n      return typeof self.chartX() != \"undefined\" && self.chartX() != null && self.chartYMulti().length > 0;\n    }\n    return typeof self.chartX() != \"undefined\" && self.chartX() != null && typeof self.chartYSingle() != \"undefined\" && self.chartYSingle() != null;\n  });\n\n  self.hasDataForChart.subscribe(function(newValue) {\n    self.chartX.notifySubscribers();\n    self.chartX.valueHasMutated();\n  });\n\n  self.chartType.subscribe(function (val) {\n    $(document).trigger(\"forceChartDraw\", self);\n  });\n\n  self.previousChartOptions = {};\n\n  function guessMetaField(field) {\n    let _fld = null;\n    if (field) {\n      if (self.result.cleanedMeta().length > 0) {\n        self.result.cleanedMeta().forEach(function (fld) {\n          if (fld.name.toLowerCase() === field.toLowerCase() || field.toLowerCase() === fld.name.toLowerCase()) {\n            _fld = fld.name;\n          }\n        });\n      }\n    }\n    return _fld;\n  }\n\n  function guessMetaFields(fields) {\n    let _fields = [];\n    if (fields) {\n      fields.forEach(function (fld) {\n        let _field = guessMetaField(fld);\n        if (_field) {\n          _fields.push(_field);\n        }\n      });\n    }\n    return _fields;\n  }\n\n  self.result.meta.subscribe(function (newValue) {\n    self.chartLimit(self.previousChartOptions.chartLimit);\n    self.chartX(guessMetaField(self.previousChartOptions.chartX));\n    self.chartXPivot(self.previousChartOptions.chartXPivot);\n    self.chartYSingle(guessMetaField(self.previousChartOptions.chartYSingle));\n    self.chartMapType(self.previousChartOptions.chartMapType);\n    self.chartMapLabel(guessMetaField(self.previousChartOptions.chartMapLabel));\n    self.chartMapHeat(self.previousChartOptions.chartMapHeat);\n    self.chartYMulti(guessMetaFields(self.previousChartOptions.chartYMulti) || []);\n    self.chartSorting(self.previousChartOptions.chartSorting);\n    self.chartScatterGroup(self.previousChartOptions.chartScatterGroup);\n    self.chartScatterSize(self.previousChartOptions.chartScatterSize);\n    self.chartScope(self.previousChartOptions.chartScope);\n    self.chartTimelineType(self.previousChartOptions.chartTimelineType);\n  });\n\n  self.isResultSettingsVisible = ko.observable(typeof snippet.isResultSettingsVisible != \"undefined\" && snippet.isResultSettingsVisible != null ? snippet.isResultSettingsVisible : false);\n  self.toggleResultSettings = function () {\n    self.isResultSettingsVisible(!self.isResultSettingsVisible());\n  };\n  self.isResultSettingsVisible.subscribe(function(){\n    $(document).trigger(\"toggleResultSettings\", self);\n  });\n\n  self.settingsVisible = ko.observable(typeof snippet.settingsVisible != \"undefined\" && snippet.settingsVisible != null ? snippet.settingsVisible : false);\n  self.saveResultsModalVisible = ko.observable(false);\n\n  self.checkStatusTimeout = null;\n\n  self.getContext = function() {\n    return {\n      id: self.id,\n      type: self.type,\n      status: self.status,\n      statementType: self.statementType,\n      statement: self.statement,\n      aceCursorPosition: self.aceCursorPosition,\n      statementPath: self.statementPath,\n      associatedDocumentUuid: self.associatedDocumentUuid,\n      properties: self.properties,\n      result: self.result.getContext(),\n      database: self.database,\n      compute: self.compute(),\n      wasBatchExecuted: self.wasBatchExecuted()\n    };\n  };\n\n  self.complexity = ko.observable();\n  self.hasComplexity = ko.pureComputed(function () {\n    return self.complexity() && Object.keys(self.complexity()).length > 0;\n  });\n  self.hasRisks = ko.pureComputed(function () {\n    return self.hasComplexity() && self.complexity()['hints'] && self.complexity()['hints'].length > 0;\n  });\n  self.topRisk = ko.pureComputed(function () {\n    if (self.hasRisks()) {\n      return self.complexity()['hints'][0];\n    } else {\n      return null;\n    }\n  });\n\n  self.suggestion = ko.observable('');\n  self.hasSuggestion = ko.observable(null);\n\n  self.compatibilityCheckRunning = ko.observable(false);\n\n  self.compatibilitySourcePlatforms = [];\n  Object.keys(COMPATIBILITY_SOURCE_PLATFORMS).forEach(function (key) {\n    self.compatibilitySourcePlatforms.push(COMPATIBILITY_SOURCE_PLATFORMS[key]);\n  });\n\n  self.compatibilitySourcePlatform = ko.observable(COMPATIBILITY_SOURCE_PLATFORMS[self.type()]);\n  self.compatibilitySourcePlatform.subscribe(function(newValue) {\n    if (newValue && newValue.value !== self.type()) {\n      self.hasSuggestion(null);\n      self.compatibilityTargetPlatform(COMPATIBILITY_TARGET_PLATFORMS[self.type()]);\n      self.queryCompatibility();\n    }\n  });\n\n  self.compatibilityTargetPlatforms = [];\n  Object.keys(COMPATIBILITY_TARGET_PLATFORMS).forEach(function (key) {\n    self.compatibilityTargetPlatforms.push(COMPATIBILITY_TARGET_PLATFORMS[key]);\n  });\n  self.compatibilityTargetPlatform = ko.observable(COMPATIBILITY_TARGET_PLATFORMS[self.type()]);\n\n  self.showOptimizer = ko.observable(apiHelper.getFromTotalStorage('editor', 'show.optimizer', false));\n  self.showOptimizer.subscribe(function (newValue) {\n    if (newValue !== null) {\n      apiHelper.setInTotalStorage('editor', 'show.optimizer', newValue);\n    }\n  });\n\n  if (HAS_OPTIMIZER && ! vm.isNotificationManager()) {\n    let lastComplexityRequest;\n    let lastCheckedComplexityStatement;\n    let knownResponses = [];\n\n    self.delayedStatement = ko.pureComputed(self.statement).extend({ rateLimit: { method: \"notifyWhenChangesStop\", timeout: 2000 } });\n\n    let handleRiskResponse = function(data) {\n      if (data.status == 0) {\n        self.hasSuggestion('');\n        self.complexity(data.query_complexity);\n      } else {\n        self.hasSuggestion('error');\n        self.complexity({'hints': []});\n      }\n      huePubSub.publish('editor.active.risks', {\n        editor: self.ace(),\n        risks: self.complexity() || {}\n      });\n      lastCheckedComplexityStatement = self.statement();\n    };\n\n    let clearActiveRisks = function () {\n      if (self.hasSuggestion() !== null && typeof self.hasSuggestion() !== 'undefined') {\n        self.hasSuggestion(null);\n      }\n\n      if (self.suggestion() !== '') {\n        self.suggestion('');\n      }\n\n      if (self.complexity() !== {}) {\n        self.complexity(undefined);\n        huePubSub.publish('editor.active.risks', {\n          editor: self.ace(),\n          risks: {}\n        });\n      }\n    };\n\n    self.positionStatement.subscribe(function (newStatement) {\n      if (newStatement) {\n        let hash = newStatement.statement.hashCode();\n        let unknownResponse = knownResponses.every(function (knownResponse) {\n          if (knownResponse.hash === hash) {\n            handleRiskResponse(knownResponse.data);\n            return false;\n          }\n          return true;\n        });\n        if (unknownResponse) {\n          clearActiveRisks();\n        }\n      }\n    });\n\n    self.checkComplexity = function () {\n      if (!self.inFocus() || lastCheckedComplexityStatement === self.statement()) {\n        return;\n      }\n\n      // The syntaxError property is only set if the syntax checker is active and has found an\n      // error, see AceLocationHandler.\n      if (self.positionStatement() && self.positionStatement().syntaxError) {\n        return;\n      }\n\n      apiHelper.cancelActiveRequest(lastComplexityRequest);\n\n      hueAnalytics.log('notebook', 'get_query_risk');\n      clearActiveRisks();\n\n      let changeSubscription = self.statement.subscribe(function () {\n        changeSubscription.dispose();\n        apiHelper.cancelActiveRequest(lastComplexityRequest);\n      });\n\n      let hash = self.statement().hashCode();\n\n      let unknownResponse = knownResponses.every(function (knownResponse) {\n        if (knownResponse.hash === hash) {\n          handleRiskResponse(knownResponse.data);\n          return false;\n        }\n        return true;\n      });\n      if (unknownResponse) {\n        lastComplexityRequest = $.ajax({\n          type: 'POST',\n          url: '/notebook/api/optimizer/statement/risk',\n          timeout: 30000, // 30 seconds\n          data: {\n            notebook: komapping.toJSON(notebook.getContext()),\n            snippet: komapping.toJSON(self.getContext())\n          },\n          success: function (data) {\n            knownResponses.unshift({\n              hash: hash,\n              data: data\n            });\n            if (knownResponses.length > 50) {\n              knownResponses.pop();\n            }\n            handleRiskResponse(data);\n          },\n          always: function(data) {\n            changeSubscription.dispose();\n          }\n        });\n      }\n    };\n\n    if (self.type() === 'hive' || self.type() === 'impala') {\n      if (self.statement_raw()) {\n        window.setTimeout(function(){\n          self.checkComplexity();\n        }, 2000);\n      }\n      self.delayedStatement.subscribe(function () {\n        self.checkComplexity();\n      });\n    }\n  }\n\n  self._ajaxError = function (data, callback) {\n    if (data.status == -2) { // Session expired\n      let existingSession = notebook.getSession(self.type());\n      if (existingSession) {\n        notebook.restartSession(existingSession, callback);\n      } else {\n        notebook.createSession(new Session(vm, {'type': self.type()}), callback);\n      }\n    } else if (data.status == -3) { // Statement expired\n      self.status('expired');\n      if (data.message) {\n        self.errors.push({message: data.message, help: null, line: null, col: null});\n        huePubSub.publish('editor.snippet.result.normal', self);\n      }\n    } else if (data.status == -4) { // Operation timed out\n      notebook.retryModalCancel = function () {\n        self.status('failed');\n        huePubSub.publish('hide.retry.modal');\n      };\n      notebook.retryModalConfirm = function () {\n        if (callback) {\n          callback();\n        }\n        huePubSub.publish('hide.retry.modal');\n      };\n      huePubSub.publish('show.retry.modal');\n    } else if (data.status == 401) { // Auth required\n      self.status('expired');\n      $(document).trigger(\"showAuthModal\", {'type': self.type(), 'callback': self.execute});\n    } else if (data.status == 1 || data.status == -1) {\n      self.status('failed');\n      let match = ERROR_REGEX.exec(data.message);\n      if (match) {\n        let errorLine = parseInt(match[1]);\n        let errorCol;\n        if (typeof match[3] !== 'undefined') {\n          errorCol = parseInt(match[3]);\n        }\n        if (self.positionStatement()) {\n          if (errorCol && errorLine === 1) {\n            errorCol += self.positionStatement().location.first_column;\n          }\n          errorLine += self.positionStatement().location.first_line - 1;\n        }\n\n        self.errors.push({\n          message: data.message.replace(match[0], 'line ' + errorLine + (errorCol !== null ? ':' + errorCol : '')),\n          help: null,\n          line: errorLine - 1,\n          col: errorCol\n        })\n      } else {\n        self.errors.push({\n          message: data.message,\n          help: data.help,\n          line: null,\n          col: null\n        });\n      }\n    } else {\n      $(document).trigger(\"error\", data.message);\n      self.status('failed');\n    }\n  };\n\n  self.wasBatchExecuted = ko.observable(typeof snippet.wasBatchExecuted != \"undefined\" && snippet.wasBatchExecuted != null ? snippet.wasBatchExecuted : false);\n  self.isReady = ko.computed(function() {\n    return (self.statementType() == 'text' && (\n        (self.isSqlDialect() && self.statement() !== '') ||\n        (['jar', 'java', 'spark2', 'distcp'].indexOf(self.type()) == -1 && self.statement() !== '') ||\n        (['jar', 'java'].indexOf(self.type()) != -1 && (self.properties().app_jar() != '' && self.properties().class() != '')) ||\n        (['spark2'].indexOf(self.type()) != -1 && self.properties().jars().length > 0) ||\n        (['shell'].indexOf(self.type()) != -1 && self.properties().command_path().length > 0) ||\n        (['mapreduce'].indexOf(self.type()) != -1 && self.properties().app_jar().length > 0) ||\n        (['distcp'].indexOf(self.type()) != -1 && self.properties().source_path().length > 0 && self.properties().destination_path().length > 0))) ||\n      (self.statementType() == 'file' && self.statementPath().length > 0) ||\n      (self.statementType() == 'document' && self.associatedDocumentUuid() && self.associatedDocumentUuid().length > 0);\n  });\n  self.lastExecuted = ko.observable(typeof snippet.lastExecuted != \"undefined\" && snippet.lastExecuted != null ? snippet.lastExecuted : 0);\n  self.lastAceSelectionRowOffset = ko.observable(snippet.lastAceSelectionRowOffset || 0);\n\n  self.executingBlockingOperation = null; // A ExecuteStatement()\n  self.showLongOperationWarning = ko.observable(false);\n  self.showLongOperationWarning.subscribe(function(newValue) {\n    if (newValue) {\n      hueAnalytics.convert('editor', 'showLongOperationWarning');\n    }\n  });\n\n  let longOperationTimeout = -1;\n\n  function startLongOperationTimeout() {\n    longOperationTimeout = window.setTimeout(function () {\n      self.showLongOperationWarning(true);\n    }, 2000);\n  }\n\n  function stopLongOperationTimeout() {\n    window.clearTimeout(longOperationTimeout);\n    self.showLongOperationWarning(false);\n  }\n\n  self.lastExecutedStatements = undefined;\n  self.lastExecutedSelectionRange = undefined;\n\n  self.execute = function (automaticallyTriggered) {\n    if (!automaticallyTriggered && self.ace()) {\n      let selectionRange = self.ace().getSelectionRange();\n\n      if (self.lastExecutedSelectionRange &&\n        (selectionRange.start.row !== selectionRange.end.row && selectionRange.start.column !== selectionRange.end.column) &&\n        (selectionRange.start.row !== self.lastExecutedSelectionRange.start.row ||\n          selectionRange.start.column !== self.lastExecutedSelectionRange.start.column ||\n          selectionRange.end.row !== self.lastExecutedSelectionRange.end.row ||\n          selectionRange.end.column !== self.lastExecutedSelectionRange.end.column)) {\n       // Manual execute and there is a selection that is different from the last execute\n        self.result.cancelBatchExecution();\n      }\n      self.lastExecutedSelectionRange = selectionRange;\n    }\n\n    if (self.isCanceling()) {\n      return;\n    }\n    let now = (new Date()).getTime();\n    if (now - self.lastExecuted() < 1000 || ! self.isReady()) {\n      return; // Prevent fast clicks\n    }\n\n    if (!automaticallyTriggered) {\n      // Do not cancel statements that are parts of a set of steps to execute (e.g. import). Only cancel statements as requested by user\n      if (self.status() === 'running' || self.status() === 'loading') {\n        self.cancel(); // TODO: Wait for cancel to finish\n      } else {\n        self.result.clear()\n      }\n    }\n\n    if (self.type() === 'impala') {\n      self.showExecutionAnalysis(false);\n      huePubSub.publish('editor.clear.execution.analysis');\n    }\n\n    self.status('running');\n    self.statusForButtons('executing');\n\n    if (self.isSqlDialect()) {\n      huePubSub.publish('editor.refresh.statement.locations', self);\n    }\n\n    self.lastExecutedStatements = self.statement();\n\n    if (self.ace()) {\n      huePubSub.publish('ace.set.autoexpand', { autoExpand: false, snippet: self });\n      let selectionRange = self.ace().getSelectionRange();\n      self.lastAceSelectionRowOffset(Math.min(selectionRange.start.row, selectionRange.end.row));\n    }\n\n    self.previousChartOptions = vm._getPreviousChartOptions(self);\n    $(document).trigger(\"executeStarted\", {vm: vm, snippet: self});\n    self.lastExecuted(now);\n    $(\".jHueNotify\").remove();\n    hueAnalytics.log('notebook', 'execute/' + self.type());\n\n    notebook.forceHistoryInitialHeight(true);\n\n    if (self.result.handle()) {\n      self.close();\n    }\n\n    self.errors([]);\n    huePubSub.publish('editor.clear.highlighted.errors', self.ace());\n    self.result.clear();\n    self.progress(0);\n    self.jobs([]);\n    self.result.logs('');\n    self.result.statement_range ({\n      start: {\n        row: 0,\n        column: 0\n      },\n      end: {\n        row: 0,\n        column: 0\n      }\n    });\n    notebook.historyCurrentPage(1);\n\n    // TODO: rename startLongOperationTimeout to startBlockingOperationTimeout\n    // TODO: stop blocking operation UI if there is one\n    // TODO: offer to stop blocking submit or fetch operation UI if there is one (add a new call to function for cancelBlockingOperation)\n    // TODO: stop current blocking operation if there is one\n    // TODO: handle jquery.dataTables.1.8.2.min.js:150 Uncaught TypeError: Cannot read property 'asSorting' of undefined on some cancels\n    // TODO: we should cancel blocking operation when leaving notebook (similar to unload())\n    // TODO: we should test when we go back to a query history of a blocking operation that we left\n    startLongOperationTimeout();\n\n    self.currentQueryTab('queryHistory');\n\n    self.executingBlockingOperation = $.post(\"/notebook/api/execute/\" + self.type(), {\n      notebook: vm.editorMode() ? komapping.toJSON(notebook, NOTEBOOK_MAPPING) : komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function (data) {\n      try {\n        if (self.isSqlDialect() && data && data.handle) {\n          self.lastExecutedStatement(sqlStatementsParser.parse(data.handle.statement)[0]);\n        } else {\n          self.lastExecutedStatement(null);\n        }\n      } catch (e) {\n        self.lastExecutedStatement(null);\n      }\n      self.statusForButtons('executed');\n      huePubSub.publish('ace.set.autoexpand', { autoExpand: true, snippet: self });\n      stopLongOperationTimeout();\n\n      if (vm.editorMode() && data.history_id) {\n        if (! vm.isNotificationManager()) {\n          let url = '/notebook/editor' + (vm.isMobile() ? '_m' : '') + '?editor=' + data.history_id;\n          if (vm.isHue4()){\n            url = vm.URLS.hue4 + '?editor=' + data.history_id;\n          }\n          vm.changeURL(url);\n        }\n        notebook.id(data.history_id);\n        notebook.uuid(data.history_uuid);\n        notebook.isHistory(true);\n        notebook.parentSavedQueryUuid(data.history_parent_uuid);\n      }\n\n      if (data.status === 0) {\n        self.result.handle(data.handle);\n        self.result.hasResultset(data.handle.has_result_set);\n        if (data.handle.sync) {\n          self.loadData(data.result, 100);\n          self.status('available');\n          self.progress(100);\n          self.result.endTime(new Date());\n        } else {\n          if (! notebook.unloaded()) {\n            self.checkStatus();\n          }\n        }\n        if (vm.isOptimizerEnabled()) {\n          huePubSub.publish('editor.upload.query', data.history_id);\n        }\n      } else {\n        self._ajaxError(data, self.execute);\n        notebook.isExecutingAll(false);\n      }\n\n      if (data.handle) {\n        if (vm.editorMode()) {\n          if (vm.isNotificationManager()) { // Update task status\n            let tasks = $.grep(notebook.history(), function(row) { return row.uuid() == notebook.uuid()});\n            if (tasks.length === 1) {\n              tasks[0].status(self.status());\n              self.result.logs(data.message);\n            }\n          } else {\n            notebook.history.unshift(\n              notebook._makeHistoryRecord(\n                url,\n                data.handle.statement,\n                self.lastExecuted(),\n                self.status(),\n                notebook.name(),\n                notebook.uuid()\n              )\n            );\n          }\n        }\n\n        if (data.handle.statements_count != null) {\n          self.result.statements_count(data.handle.statements_count);\n          self.result.statement_id(data.handle.statement_id);\n          self.result.previous_statement_hash(data.previous_statement_hash);\n\n          if (data.handle.statements_count > 1 && data.handle.start != null && data.handle.end != null) {\n            self.result.statement_range({\n              start: data.handle.start,\n              end: data.handle.end\n            });\n          }\n        }\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (self.statusForButtons() != 'canceled' && xhr.status !== 502) { // No error when manually canceled\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n      self.status('failed');\n      self.statusForButtons('executed');\n    }).always(function () {\n      self.executingBlockingOperation = null;\n    });\n  };\n\n  self.reexecute = function () {\n    self.result.cancelBatchExecution();\n    self.execute();\n  };\n\n  self.formatEnabled = ko.pureComputed(function () {\n    return self.statement_raw && self.statement_raw() != null && self.statement_raw().length < 400000; // ie: 5000 lines at 80 chars per line\n  });\n\n  self.format = function () {\n    if (self.isSqlDialect()) {\n      apiHelper.formatSql({ statements: self.ace().getSelectedText() != '' ? self.ace().getSelectedText() : self.statement_raw() }).done(function (data) {\n        if (data.status == 0) {\n          if (self.ace().getSelectedText() != '') {\n            self.ace().session.replace(self.ace().session.selection.getRange(), data.formatted_statements);\n          } else {\n            self.statement_raw(data.formatted_statements);\n            self.ace().setValue(self.statement_raw(), 1);\n          }\n        } else {\n          self._ajaxError(data);\n        }\n      });\n    }\n    hueAnalytics.log('notebook', 'format');\n  };\n\n  self.clear = function () {\n    hueAnalytics.log('notebook', 'clear');\n    self.ace().setValue('', 1);\n    self.result.clear();\n    self.status('ready');\n  };\n\n  self.explain = function () {\n    hueAnalytics.log('notebook', 'explain');\n\n    if (self.statement() == '' || self.status() == 'running' || self.status() === 'loading') {\n      return;\n    }\n\n    self.result.explanation('');\n    self.errors([]);\n    self.progress(0);\n    self.status('ready');\n\n    $.post(\"/notebook/api/explain\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function(data) {\n      if (data.status == 0) {\n        self.currentQueryTab('queryExplain');\n        self.result.fetchedOnce(true);\n        self.result.explanation(data.explanation);\n      } else {\n        self._ajaxError(data);\n      }\n    });\n  };\n\n  let lastCompatibilityRequest;\n\n  self.checkCompatibility = function () {\n    self.hasSuggestion(null);\n    self.compatibilitySourcePlatform(COMPATIBILITY_SOURCE_PLATFORMS[self.type()]);\n    self.compatibilityTargetPlatform(COMPATIBILITY_TARGET_PLATFORMS[self.type() === 'hive' ? 'impala' : 'hive']);\n    self.queryCompatibility();\n  };\n\n  self.queryCompatibility = function (targetPlatform) {\n    apiHelper.cancelActiveRequest(lastCompatibilityRequest);\n\n    hueAnalytics.log('notebook', 'compatibility');\n    self.compatibilityCheckRunning(targetPlatform != self.type());\n    self.hasSuggestion(null);\n    let positionStatement = self.positionStatement();\n\n    lastCompatibilityRequest = $.post(\"/notebook/api/optimizer/statement/compatibility\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext()),\n      sourcePlatform: self.compatibilitySourcePlatform().value,\n      targetPlatform: self.compatibilityTargetPlatform().value\n    }, function (data) {\n      if (data.status === 0) {\n        self.aceErrorsHolder([]);\n        self.aceWarningsHolder([]);\n        self.suggestion(komapping.fromJS(data.query_compatibility));\n        if (self.suggestion().queryError && self.suggestion().queryError.errorString()) {\n          let match = ERROR_REGEX.exec(self.suggestion().queryError.errorString());\n          let line = null;\n          if (match) {\n            if (positionStatement) {\n              line = positionStatement.location.first_line + parseInt(match[1]) + 1;\n            } else {\n              line = parseInt(match[1]) - 1\n            }\n          }\n          self.aceWarningsHolder.push({\n            message: self.suggestion().queryError.errorString(),\n            line: line,\n            col: match === null ? null : (typeof match[3] !== 'undefined' ? parseInt(match[3]) : null)\n          });\n          self.status('with-optimizer-report');\n        }\n        if (self.suggestion().parseError()) {\n          let match = ERROR_REGEX.exec(self.suggestion().parseError());\n          self.aceErrorsHolder.push({\n            message: self.suggestion().parseError(),\n            line: match === null ? null : parseInt(match[1]) - 1,\n            col: match === null ? null : (typeof match[3] !== 'undefined' ? parseInt(match[3]) : null)\n          });\n          self.status('with-optimizer-report');\n        }\n        self.showOptimizer(true);\n        self.hasSuggestion(true);\n      } else {\n        $(document).trigger(\"error\", data.message);\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n    }).always(function () {\n      self.compatibilityCheckRunning(false);\n    });\n  };\n\n  self.fetchResult = function (rows, startOver) {\n    if (typeof startOver == \"undefined\") {\n      startOver = true;\n    }\n    self.fetchResultData(rows, startOver);\n    //self.fetchResultMetadata(rows);\n  };\n\n  self.isFetchingData = false;\n\n  self.fetchExecutionAnalysis = function() {\n    if (self.type() === 'impala') {\n      // TODO: Use real query ID\n      huePubSub.publish('editor.update.execution.analysis', {\n        analysisPossible: true,\n        compute: self.compute(),\n        queryId: notebook.getContext().id(),\n        name: self.jobs()[0] && self.jobs()[0].name\n      });\n    } else {\n      huePubSub.publish('editor.update.execution.analysis', {\n        analysisPossible: false\n      });\n    }\n  };\n\n  self.fetchResultData = function (rows, startOver) {\n    if (! self.isFetchingData) {\n      if (self.status() === 'available') {\n        startLongOperationTimeout();\n        self.isFetchingData = true;\n        hueAnalytics.log('notebook', 'fetchResult/' + rows + '/' + startOver);\n        $.post(\"/notebook/api/fetch_result_data\", {\n          notebook: komapping.toJSON(notebook.getContext()),\n          snippet: komapping.toJSON(self.getContext()),\n          rows: rows,\n          startOver: startOver\n        }, function (data) {\n          stopLongOperationTimeout();\n          data = JSON.bigdataParse(data);\n          if (data.status === 0) {\n            self.showExecutionAnalysis(true);\n            self.loadData(data.result, rows);\n          } else {\n            self._ajaxError(data, function() {self.isFetchingData = false; self.fetchResultData(rows, startOver); });\n            $(document).trigger(\"renderDataError\", {snippet: self});\n          }\n        }, 'text').fail(function (xhr, textStatus, errorThrown) {\n          if (xhr.status !== 502) {\n            $(document).trigger(\"error\", xhr.responseText);\n          }\n        }).always(function () {\n          self.isFetchingData = false;\n        });\n      } else {\n        huePubSub.publish('editor.snippet.result.normal', self);\n      }\n    }\n  };\n\n  self.loadData = function (result, rows) {\n    rows -= result.data.length;\n\n    if (result.data.length > 0) {\n      self.currentQueryTab('queryResults');\n    }\n\n    let _initialIndex = self.result.data().length;\n    let _tempData = [];\n    $.each(result.data, function (index, row) {\n      row.unshift(_initialIndex + index + 1);\n      self.result.data.push(row);\n      _tempData.push(row);\n    });\n\n    if (self.result.rows() == null || (self.result.rows() + '').indexOf('+') != -1) {\n      self.result.rows(self.result.data().length + (result.has_more ? '+' : ''));\n    }\n\n    self.result.images(typeof result.images != \"undefined\" && result.images != null ? result.images : []);\n\n    huePubSub.publish('editor.render.data', {data: _tempData, snippet: self, initial: _initialIndex == 0});\n\n    if (! self.result.fetchedOnce()) {\n      result.meta.unshift({type: \"INT_TYPE\", name: \"\", comment: null});\n      self.result.meta(result.meta);\n      self.result.type(result.type);\n      self.result.fetchedOnce(true);\n    }\n\n    self.result.meta().forEach(function (meta) {\n      if ($.inArray(meta.type, ['TINYINT_TYPE', 'SMALLINT_TYPE', 'INT_TYPE', 'BIGINT_TYPE', 'FLOAT_TYPE', 'DOUBLE_TYPE', 'DECIMAL_TYPE']) > -1) {\n        meta.cssClass = 'sort-numeric';\n      } else if ($.inArray(meta.type, ['TIMESTAMP_TYPE', 'DATE_TYPE', 'DATETIME_TYPE']) > -1) {\n        meta.cssClass = 'sort-date';\n      } else {\n        meta.cssClass = 'sort-string';\n      }\n    });\n\n    self.result.hasMore(result.has_more);\n\n    if (result.has_more && rows > 0) {\n      setTimeout(function () {\n        self.fetchResultData(rows, false);\n      }, 500);\n    } else if (! vm.editorMode() && ! notebook.isPresentationMode() && notebook.snippets()[notebook.snippets().length - 1] == self) {\n      notebook.newSnippet();\n    }\n  };\n\n  self.fetchResultMetadata = function () {\n    $.post(\"/notebook/api/fetch_result_metadata\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function (data) {\n      if (data.status == 0) {\n        self.result.meta(data.result.meta);\n      } else {\n        $(document).trigger(\"error\", data.message);\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n      self.status('failed');\n    });\n  };\n\n  self.fetchResultSize = function(n, query_id) {\n    $.post(\"/notebook/api/fetch_result_size\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function (data) {\n      if (query_id == notebook.id()) { // If still on the same result\n        if (data.status == 0) {\n          if (data.result.rows != null) {\n            self.result.rows(data.result.rows);\n          } else if (self.type() == 'impala' && n > 0) {\n            setTimeout(function () {\n              self.fetchResultSize(n - 1, query_id);\n            }, 1000);\n          }\n        } else if (data.status == 5) {\n          // No supported yet for this snippet\n        } else {\n          //$(document).trigger(\"error\", data.message);\n        }\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      //$(document).trigger(\"error\", xhr.responseText);\n    });\n  };\n\n  self.checkStatus = function () {\n    $.post(\"/notebook/api/check_status\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function (data) {\n      if (self.statusForButtons() == 'canceling' || self.status() == 'canceled') {\n        // Query was canceled in the meantime, do nothing\n      } else {\n        self.result.endTime(new Date());\n\n        if (data.status === 0) {\n          self.status(data.query_status.status);\n\n          if (self.status() == 'running' || self.status() == 'starting' || self.status() == 'waiting') {\n            let delay = self.result.executionTime() > 45000 ? 5000 : 1000; // 5s if more than 45s\n            if (! notebook.unloaded()) {\n              self.checkStatusTimeout = setTimeout(self.checkStatus, delay);\n            }\n          } else if (self.status() === 'available') {\n            self.fetchResult(100);\n            self.progress(100);\n            if (self.isSqlDialect()) {\n              if (self.result.handle().has_result_set) {\n                let _query_id = notebook.id();\n                setTimeout(function () { // Delay until we get IMPALA-5555\n                  self.fetchResultSize(10, _query_id);\n                }, 2000);\n                self.checkDdlNotification(); // DDL CTAS with Impala\n              } else if (self.lastExecutedStatement()) {\n                self.checkDdlNotification();\n              } else {\n                self.onDdlExecute();\n              }\n            }\n            if (notebook.isExecutingAll()) {\n              notebook.executingAllIndex(notebook.executingAllIndex() + 1);\n              if (notebook.executingAllIndex() < notebook.snippets().length) {\n                notebook.snippets()[notebook.executingAllIndex()].execute();\n              } else {\n                notebook.isExecutingAll(false);\n              }\n            }\n            if (! self.result.handle().has_more_statements && vm.successUrl()) {\n              window.location.href = vm.successUrl(); // Not used anymore in Hue 4\n            }\n          } else if (self.status() === 'success') {\n            self.progress(99);\n          }\n        } else if (data.status === -3) {\n          self.status('expired');\n          notebook.isExecutingAll(false);\n        } else {\n          self._ajaxError(data);\n          notebook.isExecutingAll(false);\n        }\n        self.getLogs(); // Need to execute at the end, because updating the status impacts log progress results\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText || textStatus);\n      }\n      self.status('failed');\n      notebook.isExecutingAll(false);\n    });\n  };\n\n  self.checkDdlNotification = function() {\n    if (self.lastExecutedStatement() && /ALTER|CREATE|DELETE|DROP|GRANT|INSERT|LOAD|SET|TRUNCATE|UPDATE|UPSERT|USE/i.test(self.lastExecutedStatement().firstToken)) {\n      self.onDdlExecute();\n    } else {\n      window.clearTimeout(self.executeNextTimeout);\n    }\n  };\n\n  self.isCanceling = ko.observable(false);\n\n  self.cancel = function () {\n    window.clearTimeout(self.executeNextTimeout);\n    self.isCanceling(true);\n    if (self.checkStatusTimeout != null) {\n      clearTimeout(self.checkStatusTimeout);\n      self.checkStatusTimeout = null;\n    }\n    hueAnalytics.log('notebook', 'cancel');\n\n    if (self.executingBlockingOperation != null) {\n      self.executingBlockingOperation.abort();\n      self.executingBlockingOperation = null;\n    }\n\n    if ($.isEmptyObject(self.result.handle())) { // Query was not even submitted yet\n      self.statusForButtons('canceled');\n      self.status('failed');\n      self.isCanceling(false);\n      notebook.isExecutingAll(false);\n    } else {\n      self.statusForButtons('canceling');\n      $.post(\"/notebook/api/cancel_statement\", {\n        notebook: komapping.toJSON(notebook.getContext()),\n        snippet: komapping.toJSON(self.getContext())\n      }, function (data) {\n        self.statusForButtons('canceled');\n        if (data.status == 0) {\n          self.status('canceled');\n          notebook.isExecutingAll(false);\n        } else {\n          self._ajaxError(data);\n        }\n      }).fail(function (xhr, textStatus, errorThrown) {\n        if (xhr.status !== 502) {\n          $(document).trigger(\"error\", xhr.responseText);\n        }\n        self.statusForButtons('canceled');\n        self.status('failed');\n        notebook.isExecutingAll(false);\n      }).always(function (){\n        self.isCanceling(false);\n      });\n    }\n  };\n\n  self.close = function () {\n    if (self.checkStatusTimeout != null) {\n      clearTimeout(self.checkStatusTimeout);\n      self.checkStatusTimeout = null;\n    }\n\n    $.post(\"/notebook/api/close_statement\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext())\n    }, function (data) {\n      if (data.status == 0) {\n        // self.status('closed'); // Keep as 'running' as currently it happens before running a new query\n      } else {\n        // self._ajaxError(data);\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        // $(document).trigger(\"error\", xhr.responseText);\n      }\n      // self.status('failed'); // Can conflict with slow close and new query execution\n    });\n  };\n\n  self.getLogs = function () {\n    $.post(\"/notebook/api/get_logs\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext()),\n      from: self.result.logLines,\n      jobs: komapping.toJSON(self.jobs, { ignore: ['percentJob'] }),\n      full_log: self.result.logs\n    }, function (data) {\n      if (data.status == 1) { // Append errors to the logs\n        data.status = 0;\n        data.logs = data.message;\n      }\n      if (data.status == 0) {\n        if (data.logs.length > 0) {\n          let logs = data.logs.split(\"\\n\");\n          self.result.logLines += logs.length;\n          let oldLogs = self.result.logs();\n          if (data.logs && (\n              oldLogs === \"\" || (self.wasBatchExecuted() && data.logs.indexOf('Unable to locate') == -1) || data.isFullLogs)) {\n            self.result.logs(data.logs);\n          } else {\n            self.result.logs(oldLogs + \"\\n\" + data.logs);\n          }\n        }\n\n        self.jobs().forEach(function(job){\n          if (typeof job.percentJob === 'undefined'){\n            job.percentJob = ko.observable(-1);\n          }\n        });\n\n        if (data.jobs && data.jobs.length > 0) {\n          data.jobs.forEach(function (job) {\n            let _found = ko.utils.arrayFilter(self.jobs(), function (item) {\n              return item.name === job.name;\n            });\n            if (_found.length === 0) {\n              if (typeof job.percentJob === 'undefined') {\n                job.percentJob = ko.observable(-1);\n              } else {\n                job.percentJob = ko.observable(job.percentJob);\n              }\n              self.jobs.push(job);\n            } else if (typeof job.percentJob !== 'undefined') {\n              for (let i = 0; i < _found.length; i++) {\n                _found[i].percentJob(job.percentJob)\n              }\n            }\n          });\n          self.jobs().forEach(function (job) {\n            let _found = ko.utils.arrayFilter(self.jobs(), function (item) {\n              return item.name === job.name;\n            });\n            if (_found.length === 0) {\n              self.jobs.remove(job);\n            }\n          });\n        }\n        if (self.status() == 'running') { // Maybe the query finished or failed in the meantime\n          self.progress(data.progress)\n        };\n      } else {\n        self._ajaxError(data);\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText || textStatus);\n      }\n      self.status('failed');\n    });\n  };\n\n  self.uploadQueryHistory = function (n) {\n    hueAnalytics.log('notebook', 'upload_query_history');\n\n    $.post(\"/metadata/api/optimizer/upload/history\", {\n      n: typeof n != \"undefined\" ? n : null,\n      sourcePlatform: self.type()\n    }, function(data) {\n      if (data.status == 0) {\n        $(document).trigger(\"info\", data.upload_history[self.type()].count + \" queries uploaded successfully. Processing them...\");\n        self.watchUploadStatus(data.upload_history[self.type()].status.workloadId);\n      } else {\n        $(document).trigger(\"error\", data.message);\n      }\n    });\n  };\n\n  self.uploadQuery = function (query_id) {\n    $.post(\"/metadata/api/optimizer/upload/query\", {\n      query_id: query_id,\n      sourcePlatform: self.type()\n    });\n  };\n\n  self.uploadTableStats = function (options) {\n    hueAnalytics.log('notebook', 'load_table_stats');\n    if (options.showProgress) {\n      $(document).trigger(\"info\", \"Preparing table data...\");\n    }\n\n    $.post(\"/metadata/api/optimizer/upload/table_stats\", {\n      db_tables: komapping.toJSON($.map(options.activeTables, function(table) {\n        return table.databaseName + '.' + table.tableName;\n      })),\n      sourcePlatform: komapping.toJSON(self.type()),\n      with_ddl: komapping.toJSON(true),\n      with_table_stats: komapping.toJSON(true),\n      with_columns_stats: komapping.toJSON(true)\n    }, function(data) {\n      if (data.status == 0) {\n        if (options.showProgress) {\n          $(document).trigger(\"info\", $.map(options.activeTables, function(table) { return table.tableName; }) + \" stats sent to analyse\");\n        }\n        if (data.upload_table_ddl && options.showProgress) { // With showProgress only currently as can be very slow\n          self.watchUploadStatus(data.upload_table_ddl.status.workloadId, options.showProgress);\n        }\n      } else {\n        if (options.showProgress) {\n          $(document).trigger(\"error\", data.message);\n        }\n      }\n    }).always(function () {\n      if (options.callback) {\n        options.callback();\n      }\n    });\n  };\n\n  self.watchUploadStatus = function (workloadId, showProgress) {\n    $.post(\"/metadata/api/optimizer/upload/status\", {\n      workloadId: workloadId\n    }, function(data) {\n      if (data.status == 0) {\n        if (showProgress) {\n          $(document).trigger(\"info\", \"Query processing: \" + data.upload_status.status.state);\n        }\n        if (['WAITING', 'IN_PROGRESS'].indexOf(data.upload_status.status.state) != -1) {\n          window.setTimeout(function () {\n            self.watchUploadStatus(workloadId);\n          }, 2000);\n        } else {\n          if (showProgress) {\n            $(document).trigger(\"warn\", data.upload_status.status.statusMsg + (data.upload_status.status.failedQueries > 0 ? '. ' + data.upload_status.status.failQueryDetails.map(function(query) { return query.error; }) : ''));\n          }\n        }\n      } else {\n        if (showProgress) {\n          $(document).trigger(\"error\", data.message);\n        }\n      }\n    });\n  };\n\n  self.getSimilarQueries = function () {\n    hueAnalytics.log('notebook', 'get_query_similarity');\n\n    $.post(\"/notebook/api/optimizer/statement/similarity\", {\n      notebook: komapping.toJSON(notebook.getContext()),\n      snippet: komapping.toJSON(self.getContext()),\n      sourcePlatform: self.type()\n    }, function(data) {\n      if (data.status == 0) {\n        console.log(data.statement_similarity);\n      } else {\n        $(document).trigger(\"error\", data.message);\n      }\n    });\n  };\n\n  self.autocompleter = new Autocompleter({\n    snippet: self,\n    user: vm.user,\n    optEnabled: false,\n    timeout: vm.autocompleteTimeout,\n    useNewAutocompleter: vm.useNewAutocompleter\n  });\n\n  self.init = function () {\n    if ((self.status() == 'running' || self.status() == 'available') && notebook.isHistory()) {\n      self.checkStatus();\n    } else if (self.status() == 'loading') {\n      self.status('failed');\n      self.progress(0);\n      self.jobs([]);\n    } else if (self.status() == 'ready-execute') {\n      self.execute();\n    }\n  };\n\n  self.onKeydownInVariable = function (context, e) {\n    if ((e.ctrlKey || e.metaKey) && e.which === 13) { // Ctrl-enter\n      self.ace().commands.commands['execute'].exec();\n    } else if ((e.ctrlKey || e.metaKey) && e.which === 83) { // Ctrl-s\n      self.ace().commands.commands['save'].exec();\n      e.preventDefault(); // Prevent browser page save dialog\n    }\n    return true;\n  };\n};\n\nlet Session = function(vm, session) {\n  let self = this;\n  komapping.fromJS(session, {}, self);\n\n  self.selectedSessionProperty = ko.observable('');\n\n  self.restarting = ko.observable(false);\n\n  if (! ko.isObservable(self.properties)) {\n    self.properties = ko.observableArray();\n  }\n\n  self.availableNewProperties = ko.computed(function() {\n    let addedIndex = {};\n    $.each(self.properties(), function(index, property) {\n      addedIndex[property.key] = true;\n    });\n    let result = $.grep(vm.availableSessionProperties(), function(property) {\n      return ! addedIndex[property.name];\n    });\n    return result;\n  });\n};\n\nlet Notebook = function (vm, notebook) {\n  let self = this;\n\n  self.id = ko.observable(typeof notebook.id != \"undefined\" && notebook.id != null ? notebook.id : null);\n  self.uuid = ko.observable(typeof notebook.uuid != \"undefined\" && notebook.uuid != null ? notebook.uuid : hueUtils.UUID());\n  self.name = ko.observable(typeof notebook.name != \"undefined\" && notebook.name != null ? notebook.name : 'My Notebook');\n  self.description = ko.observable(typeof notebook.description != \"undefined\" && notebook.description != null ? notebook.description: '');\n  self.type = ko.observable(typeof notebook.type != \"undefined\" && notebook.type != null ? notebook.type : 'notebook');\n  self.initialType = self.type().replace('query-', '');\n  self.coordinatorUuid = ko.observable(typeof notebook.coordinatorUuid != \"undefined\" && notebook.coordinatorUuid != null ? notebook.coordinatorUuid : null);\n  self.isHistory = ko.observable(typeof notebook.is_history != \"undefined\" && notebook.is_history != null ? notebook.is_history : false);\n  self.isManaged = ko.observable(typeof notebook.isManaged != \"undefined\" && notebook.isManaged != null ? notebook.isManaged : false);\n  self.parentSavedQueryUuid = ko.observable(typeof notebook.parentSavedQueryUuid != \"undefined\" && notebook.parentSavedQueryUuid != null ? notebook.parentSavedQueryUuid : null); // History parent\n  self.isSaved = ko.observable(typeof notebook.isSaved != \"undefined\" && notebook.isSaved != null ? notebook.isSaved : false);\n  self.canWrite = ko.observable(typeof notebook.can_write != \"undefined\" && notebook.can_write != null ? notebook.can_write : true);\n  self.onSuccessUrl = ko.observable(typeof notebook.onSuccessUrl != \"undefined\" && notebook.onSuccessUrl != null ? notebook.onSuccessUrl : null);\n  self.pubSubUrl = ko.observable(typeof notebook.pubSubUrl != \"undefined\" && notebook.pubSubUrl != null ? notebook.pubSubUrl : null);\n  self.isPresentationModeDefault = ko.observable(typeof notebook.isPresentationModeDefault != \"undefined\" && notebook.isPresentationModeDefault != null ? notebook.isPresentationModeDefault : false);\n  self.isPresentationMode = ko.observable(false);\n  self.isPresentationModeInitialized = ko.observable(false);\n  self.isPresentationMode.subscribe(function(newValue) {\n    if (! newValue) {\n      self.cancelExecutingAll();\n    }\n    huePubSub.publish('editor.presentation.operate.toggle', newValue); // Problem with headers / row numbers redraw on full screen results\n    vm.togglePresentationMode();\n    if (newValue) {\n      hueAnalytics.convert('editor', 'presentation');\n    }\n  });\n  self.presentationSnippets = ko.observable({});\n  self.isHidingCode = ko.observable(typeof notebook.isHidingCode != \"undefined\" && notebook.isHidingCode != null ? notebook.isHidingCode : false);\n\n  self.snippets = ko.observableArray();\n  self.selectedSnippet = ko.observable(vm.editorType()); // Aka selectedSnippetType\n  self.creatingSessionLocks = ko.observableArray();\n  self.sessions = komapping.fromJS(typeof notebook.sessions != \"undefined\" && notebook.sessions != null ? notebook.sessions : [], {\n    create: function(value) {\n      return new Session(vm, value.data);\n    }\n  });\n  self.directoryUuid = ko.observable(typeof notebook.directoryUuid != \"undefined\" && notebook.directoryUuid != null ? notebook.directoryUuid : null);\n  self.dependents = komapping.fromJS(typeof notebook.dependents != \"undefined\" && notebook.dependents != null ? notebook.dependents : []);\n  self.dependentsCoordinator = ko.computed(function() {\n    return $.grep(self.dependents(), function(doc) { return doc.type() == 'oozie-coordinator2' && doc.is_managed() == true ;})\n  });\n  if (self.dependentsCoordinator().length > 0 && ! self.coordinatorUuid()) {\n    self.coordinatorUuid(self.dependentsCoordinator()[0].uuid());\n  }\n  self.history = ko.observableArray(vm.selectedNotebook() && vm.selectedNotebook().history().length > 0 && vm.selectedNotebook().history()[0].type == self.type() ? vm.selectedNotebook().history() : []);\n  self.history.subscribe(function(val) {\n    if (self.id() == null && val.length == 0 && self.historyFilter() === '' && ! vm.isNotificationManager()) {\n      self.snippets()[0].currentQueryTab((typeof IS_EMBEDDED !== 'undefined' && IS_EMBEDDED) ? 'queryHistory' : 'savedQueries');\n    }\n  });\n  self.historyFilter = ko.observable('');\n  self.historyFilterVisible = ko.observable(false);\n  self.historyFilter.extend({ rateLimit: { method: \"notifyWhenChangesStop\", timeout: 900 } });\n  self.historyFilter.subscribe(function(val){\n    if (self.historyCurrentPage() != 1) {\n      self.historyCurrentPage(1);\n    } else {\n      self.fetchHistory();\n    }\n  });\n  self.loadingHistory = ko.observable(self.history().length == 0);\n  self.historyInitialHeight = ko.observable(0).extend({ throttle: 1000 });\n  self.forceHistoryInitialHeight = ko.observable(false);\n  self.historyCurrentPage = ko.observable(vm.selectedNotebook() ? vm.selectedNotebook().historyCurrentPage() : 1);\n  self.historyCurrentPage.subscribe(function(val) {\n    self.fetchHistory();\n  });\n  self.historyTotalPages = ko.observable(vm.selectedNotebook() ? vm.selectedNotebook().historyTotalPages() : 1);\n\n  self.schedulerViewModel = null;\n  self.schedulerViewModelIsLoaded = ko.observable(false);\n  self.schedulerViewerViewModel = ko.observable();\n  self.isBatchable = ko.computed(function() {\n    return self.snippets().length > 0\n      && $.grep(self.snippets(), function (snippet) {\n        return snippet.isBatchable();\n      }).length == self.snippets().length;\n  });\n\n  self.isExecutingAll = ko.observable(!! notebook.isExecutingAll);\n  self.cancelExecutingAll = function() {\n    let index = self.executingAllIndex();\n    if (self.isExecutingAll() && self.snippets()[index]) {\n      self.snippets()[index].cancel();\n    }\n  };\n  self.executingAllIndex = ko.observable(notebook.executingAllIndex || 0);\n\n  self.retryModalConfirm = null;\n  self.retryModalCancel = null;\n\n  self.avoidClosing = false;\n\n  self.canSave = vm.canSave;\n\n\n  self.getSession = function (session_type) {\n    let _s = null;\n    $.each(self.sessions(), function (index, s) {\n      if (s.type() == session_type) {\n        _s = s;\n        return false;\n      }\n    });\n    return _s;\n  };\n\n  self.getSnippets = function(type) {\n    return $.grep(self.snippets(), function (snippet) {\n      return snippet.type() == type;\n    });\n  };\n\n  self.unloaded = ko.observable(false);\n  self.unload = function() {\n    self.unloaded(true);\n    let currentQueries = null;\n    self.snippets().forEach(function(snippet){\n      if (snippet.checkStatusTimeout != null) {\n        clearTimeout(snippet.checkStatusTimeout);\n        snippet.checkStatusTimeout = null;\n      }\n      if (currentQueries == null) {\n        currentQueries = snippet.queries();\n      }\n    });\n    return currentQueries;\n  }\n\n  self.restartSession = function (session, callback) {\n    if (session.restarting()) {\n      return;\n    }\n    session.restarting(true);\n    let snippets = self.getSnippets(session.type());\n\n    $.each(snippets, function(index, snippet) {\n      snippet.status('loading');\n    });\n\n    let sessionJson = komapping.toJSON(session);\n\n    self.closeSession (session, true, function() {\n      self.createSession(session, function () {\n        $.each(snippets, function(index, snippet) {\n          snippet.status('ready');\n        });\n        session.restarting(false);\n        if (callback) {\n          callback();\n        }\n      }, function () {\n        session.restarting(false);\n      });\n    });\n  };\n\n  self.addSession = function (session) {\n    let toRemove = [];\n    $.each(self.sessions(), function (index, s) {\n      if (s.type() == session.type()) {\n        toRemove.push(s);\n      }\n    });\n\n    $.each(toRemove, function (index, s) {\n      self.sessions.remove(s);\n    });\n\n    self.sessions.push(session);\n  };\n\n  self.addSnippet = function (snippet, skipSession) {\n    let _snippet = new Snippet(vm, self, snippet);\n    self.snippets.push(_snippet);\n\n    if (self.getSession(_snippet.type()) == null && typeof skipSession == \"undefined\") {\n      window.setTimeout(function() {\n        _snippet.status('loading');\n        self.createSession(new Session(vm, {'type': _snippet.type()}));\n      }, 200);\n    }\n\n    _snippet.init();\n    return _snippet;\n  };\n\n  self.createSession = function (session, callback, failCallback) {\n    if (self.creatingSessionLocks().indexOf(session.type()) != -1) { // Create one type of session max\n      return;\n    } else {\n      self.creatingSessionLocks.push(session.type());\n    }\n\n    let compute = null;\n    $.each(self.getSnippets(session.type()), function(index, snippet) {\n      snippet.status('loading');\n      if (index == 0) {\n        compute = snippet.compute();\n      }\n    });\n\n    let fail = function (message) {\n      $.each(self.getSnippets(session.type()), function(index, snippet) {\n        snippet.status('failed');\n      });\n      $(document).trigger(\"error\", message);\n      if (failCallback) {\n        failCallback();\n      }\n    };\n\n    $.post(\"/notebook/api/create_session\", {\n      notebook: komapping.toJSON(self.getContext()),\n      session: komapping.toJSON(session), // e.g. {'type': 'pyspark', 'properties': [{'name': driverCores', 'value', '2'}]}\n      cluster: komapping.toJSON(compute ? compute : '')\n    }, function (data) {\n      if (data.status == 0) {\n        komapping.fromJS(data.session, {}, session);\n        if (self.getSession(session.type()) == null) {\n          self.addSession(session);\n        }\n        $.each(self.getSnippets(session.type()), function(index, snippet) {\n          snippet.status('ready');\n        });\n        if (callback) {\n          setTimeout(callback, 500);\n        }\n      } else if (data.status == 401) {\n        $(document).trigger(\"showAuthModal\", {'type': session.type()});\n      }\n      else {\n        fail(data.message);\n      }\n    }).fail(function (xhr) {\n      if (xhr.status !== 502) {\n        fail(xhr.responseText);\n      }\n    }).always(function() {\n      self.creatingSessionLocks.remove(session.type());\n    })\n  };\n\n  self.authSession = function () {\n    self.createSession(new Session(vm, {\n        'type': vm.authSessionType(),\n        'properties': [\n          {'name': 'user', 'value': vm.authSessionUsername()},\n          {'name': 'password', 'value': vm.authSessionPassword()}\n        ]\n      }),\n      vm.authSessionCallback()  // On new session we don't automatically execute the snippet after the aut. On session expiration we do or we refresh assist DB when login-in.\n    );\n  };\n\n  self.newSnippet = function (type) {\n    if (type) {\n      self.selectedSnippet(type);\n    }\n    let snippet = self.addSnippet({\n      type: self.selectedSnippet(),\n      result: {}\n    });\n\n    window.setTimeout(function () {\n      let lastSnippet = snippet;\n      if (lastSnippet.ace() != null) {\n        lastSnippet.ace().focus();\n      }\n    }, 100);\n\n    hueAnalytics.log('notebook', 'add_snippet/' + (type ? type : self.selectedSnippet()));\n    return snippet;\n  };\n\n  self.newSnippetAbove = function (id) {\n    self.newSnippet();\n    let idx = 0;\n    self.snippets().forEach(function (snippet, cnt) {\n      if (snippet.id() == id) idx = cnt;\n    });\n    self.snippets(self.snippets().move(self.snippets().length - 1, idx));\n  };\n\n  self.getContext = function() {\n   return {\n       id: self.id,\n       uuid: self.uuid,\n       parentSavedQueryUuid: self.parentSavedQueryUuid,\n       isSaved: self.isSaved,\n       sessions: self.sessions,\n       type: self.type,\n       name: self.name\n    };\n  };\n\n  self.save = function (callback) {\n    hueAnalytics.log('notebook', 'save');\n\n    // Remove the result data from the snippets\n    // Also do it for presentation mode\n    let cp = komapping.toJS(self, NOTEBOOK_MAPPING);\n    $.each(cp.snippets.concat(Object.keys(cp.presentationSnippets).map(function(key){\n        return cp.presentationSnippets[key];\n      })), function(index, snippet) {\n      snippet.result.data.length = 0; // snippet.result.clear() does not work for some reason\n      snippet.result.meta.length = 0;\n      snippet.result.logs = '';\n      snippet.result.fetchedOnce = false;\n      snippet.progress = 0; // Remove progress\n      snippet.jobs.length = 0;\n    });\n    if (cp.schedulerViewModel) {\n      cp.schedulerViewModel.availableTimezones = [];\n    }\n    let editorMode = vm.editorMode() || (self.isPresentationMode() && vm.editorType() != 'notebook'); // Editor should not convert to Notebook in presentation mode\n\n    $.post(\"/notebook/api/notebook/save\", {\n      \"notebook\": komapping.toJSON(cp, NOTEBOOK_MAPPING),\n      \"editorMode\": editorMode\n    }, function (data) {\n      if (data.status == 0) {\n        self.id(data.id);\n        self.isSaved(true);\n        let wasHistory = self.isHistory();\n        self.isHistory(false);\n        $(document).trigger(\"info\", data.message);\n        if (editorMode) {\n          if (! data.save_as) {\n            let existingQuery = self.snippets()[0].queries().filter(function (item) {\n              return item.uuid() === data.uuid\n            });\n            if (existingQuery.length > 0) {\n              existingQuery[0].name(data.name);\n              existingQuery[0].description(data.description);\n              existingQuery[0].last_modified(data.last_modified);\n            }\n          } else if (self.snippets()[0].queries().length > 0) { // Saved queries tab already loaded\n            self.snippets()[0].queries.unshift(komapping.fromJS(data));\n          }\n\n          if (self.coordinatorUuid() && self.schedulerViewModel) {\n            self.saveScheduler();\n            self.schedulerViewModel.coordinator.refreshParameters();\n          }\n          if (wasHistory || data.save_as) {\n            self.loadScheduler();\n          }\n\n          if (self.snippets()[0].downloadResultViewModel && self.snippets()[0].downloadResultViewModel().saveTarget() === 'dashboard') {\n            huePubSub.publish('open.link', vm.URLS.report + '&uuid=' + data.uuid + '&statement=' + self.snippets()[0].result.handle().statement_id);\n          }\n          else {\n            if (vm.isHue4()){\n              vm.changeURL(vm.URLS.hue4 + '?editor=' + data.id);\n            } else {\n              vm.changeURL('/notebook/editor' + (vm.isMobile() ? '_m' : '') + '?editor=' + data.id);\n            }\n          }\n        } else {\n          if (vm.isHue4()){\n            vm.changeURL(vm.URLS.hue4_notebook + '?notebook=' + data.id);\n          } else {\n            vm.changeURL('/notebook/notebook?notebook=' + data.id);\n          }\n        }\n        if (typeof callback == \"function\") {\n          callback();\n        }\n      } else {\n        $(document).trigger(\"error\", data.message);\n      }\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n    });\n  };\n\n  self.close = function () {\n    hueAnalytics.log('notebook', 'close');\n    $.post(\"/notebook/api/notebook/close\", {\n      \"notebook\": komapping.toJSON(self, NOTEBOOK_MAPPING),\n      \"editorMode\": vm.editorMode()\n    });\n  };\n\n  self.clearResults = function () {\n    $.each(self.snippets(), function (index, snippet) {\n      snippet.result.clear();\n      snippet.status('ready');\n    });\n  };\n\n  self.executeAll = function () {\n    if (self.isExecutingAll() || self.snippets().length === 0) {\n      return;\n    }\n\n    self.isExecutingAll(true);\n    self.executingAllIndex(0);\n\n    self.snippets()[self.executingAllIndex()].execute();\n  };\n\n  self.saveDefaultUserProperties = function (session) {\n    apiHelper.saveConfiguration({\n      app: session.type(),\n      properties: session.properties,\n      userId: vm.userId\n    });\n  };\n\n  self.closeAndRemoveSession = function (session) {\n    self.closeSession(session, false, function() {\n      self.sessions.remove(session);\n    });\n  };\n\n  self.closeSession = function (session, silent, callback) {\n    $.post(\"/notebook/api/close_session\", {\n      session: komapping.toJSON(session)\n    }, function (data) {\n      if (! silent && data && data.status != 0 && data.status != -2 && data.message) {\n        $(document).trigger(\"error\", data.message);\n      }\n\n      if (callback) {\n        callback();\n      }\n    }).fail(function (xhr) {\n      if (!silent && xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n    });\n  };\n\n  self.fetchHistory = function (callback) {\n    let QUERIES_PER_PAGE = 50;\n    self.loadingHistory(true);\n\n    $.get(\"/notebook/api/get_history\", {\n      doc_type: self.selectedSnippet(),\n      limit: QUERIES_PER_PAGE,\n      page: self.historyCurrentPage(),\n      doc_text: self.historyFilter(),\n      is_notification_manager: vm.isNotificationManager()\n    }, function(data) {\n      let parsedHistory = [];\n      if (data && data.history){\n        data.history.forEach(function(nbk){\n          parsedHistory.push(\n            self._makeHistoryRecord(\n              nbk.absoluteUrl,\n              nbk.data.statement,\n              nbk.data.lastExecuted,\n              nbk.data.status,\n              nbk.name,\n              nbk.uuid\n            )\n          );\n        });\n      }\n      self.history(parsedHistory);\n      self.historyTotalPages(Math.ceil(data.count / QUERIES_PER_PAGE));\n    }).always(function(){\n      self.loadingHistory(false);\n      if (callback) {\n        callback();\n      }\n    });\n  };\n\n  self.prevHistoryPage = function () {\n    if (self.historyCurrentPage() !== 1) {\n      self.historyCurrentPage(self.historyCurrentPage() - 1);\n    }\n  };\n\n  self.nextHistoryPage = function () {\n    if (self.historyCurrentPage() < self.historyTotalPages()) {\n      self.historyCurrentPage(self.historyCurrentPage() + 1);\n    }\n  };\n\n\n  self.updateHistoryFailed = false;\n  self.updateHistory = function (statuses, interval) {\n    let items = $.grep(self.history(), function (item) {\n      return statuses.indexOf(item.status()) != -1;\n    }).slice(0, 25);\n\n    function updateHistoryCall(item) {\n      $.post(\"/notebook/api/check_status\", {\n        notebook: komapping.toJSON({id: item.uuid()}),\n      }).done(function (data) {\n          let status = data.status == -3 ? 'expired' : (data.status == 0 ? data.query_status.status : 'failed');\n          if (status && item.status() != status) {\n            item.status(status);\n          }\n        }).fail(function (xhr) {\n          items = [];\n          self.updateHistoryFailed = true;\n          console.warn('Lost connectivity to the Hue history refresh backend.');\n        }).always(function () {\n          if (items.length > 0) {\n            window.setTimeout(function () {\n              updateHistoryCall(items.pop());\n            }, 1000);\n          } else {\n            if (!self.updateHistoryFailed){\n              window.setTimeout(function () {\n                self.updateHistory(statuses, interval);\n              }, interval);\n            }\n          }\n        });\n    }\n\n    if (items.length > 0) {\n      updateHistoryCall(items.pop());\n    } else {\n      if (!self.updateHistoryFailed) {\n        window.setTimeout(function () {\n          self.updateHistory(statuses, interval);\n        }, interval);\n      }\n    }\n  };\n\n  self._makeHistoryRecord = function(url, statement, lastExecuted, status, name, uuid) {\n    return komapping.fromJS({\n        url: url,\n        query: statement.substring(0, 1000) + (statement.length > 1000 ? '...' : ''),\n        lastExecuted: lastExecuted,\n        status: status,\n        name: name,\n        uuid: uuid\n    });\n  };\n\n  self.clearHistory = function (type) {\n    hueAnalytics.log('notebook', 'clearHistory');\n    $.post(\"/notebook/api/clear_history\", {\n      notebook: komapping.toJSON(self.getContext()),\n      doc_type: self.selectedSnippet(),\n      is_notification_manager: vm.isNotificationManager(),\n    }, function (data) {\n      self.history.removeAll();\n      if (self.isHistory()) {\n        self.id(null);\n        self.uuid(hueUtils.UUID());\n        if (vm.isHue4()) {\n          vm.changeURL(vm.URLS.hue4 + '?type=' + vm.editorType());\n        }\n        else {\n          vm.changeURL('/notebook/editor' + (vm.isMobile() ? '_m' : '') + '?type=' + vm.editorType());\n        }\n      }\n    }).fail(function (xhr) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n    });\n    $(document).trigger(\"hideHistoryModal\");\n  };\n\n  self.loadScheduler = function () {\n    if (typeof vm.CoordinatorEditorViewModel !== 'undefined' && self.isBatchable()) {\n      let _action;\n      if (self.coordinatorUuid()) {\n        _action = 'edit';\n      } else {\n        _action = 'new';\n      }\n      hueAnalytics.log('notebook', 'schedule/' + _action);\n\n      let getCoordinator = function() {\n        $.get('/oozie/editor/coordinator/' + _action + '/', {\n          format: 'json',\n          document: self.uuid(),\n          coordinator: self.coordinatorUuid()\n        }, function (data) {\n          if ($(\"#schedulerEditor\").length > 0) {\n            huePubSub.publish('hue4.process.headers', {\n              response: data.layout,\n              callback: function (r) {\n                $(\"#schedulerEditor\").html(r);\n\n                self.schedulerViewModel = new vm.CoordinatorEditorViewModel(data.coordinator, data.credentials, data.workflows, data.can_edit);\n\n                ko.cleanNode($(\"#schedulerEditor\")[0]);\n                ko.applyBindings(self.schedulerViewModel, $(\"#schedulerEditor\")[0]);\n                $(document).off(\"showSubmitPopup\");\n                $(document).on(\"showSubmitPopup\", function (event, data) {\n                  $('.submit-modal-editor').html(data);\n                  $('.submit-modal-editor').modal('show');\n                  $('.submit-modal-editor').on('hidden', function () {\n                    huePubSub.publish('hide.datepicker');\n                  });\n                  let _sel = $('.submit-form .control-group[rel!=\"popover\"]:visible');\n                  if (_sel.length > 0) {\n                    $('.submit-modal-editor .modal-body').height($('.submit-modal-editor .modal-body').height() + 60);\n                  }\n                });\n\n                huePubSub.publish('render.jqcron');\n\n                self.schedulerViewModel.coordinator.properties.cron_advanced.valueHasMutated(); // Update jsCron enabled status\n                self.schedulerViewModel.coordinator.tracker().markCurrentStateAsClean();\n                self.schedulerViewModel.isEditing(true);\n\n                self.schedulerViewModelIsLoaded(true);\n\n                if (_action == 'new') {\n                  self.schedulerViewModel.coordinator.properties.document(self.uuid()); // Expected for triggering the display\n                }\n              }\n            });\n\n          }\n        }).fail(function (xhr) {\n          if (xhr.status !== 502) {\n            $(document).trigger(\"error\", xhr.responseText);\n          }\n        });\n      }\n\n      if (!IS_HUE_4) {\n        huePubSub.subscribe('hue4.process.headers', function (opts) {\n          opts.callback(opts.response);\n        }, vm.huePubSubId);\n      }\n\n      getCoordinator();\n    }\n  };\n\n  self.saveScheduler = function() {\n    if (self.isBatchable() && (! self.coordinatorUuid() || self.schedulerViewModel.coordinator.isDirty())) {\n      self.schedulerViewModel.coordinator.isManaged(true);\n      self.schedulerViewModel.coordinator.properties.document(self.uuid());\n      self.schedulerViewModel.save(function(data) {\n        if (! self.coordinatorUuid()) {\n          self.coordinatorUuid(data.uuid);\n          self.save();\n        }\n      });\n    }\n  };\n\n  self.showSubmitPopup = function () {\n    $.get('/oozie/editor/coordinator/submit/' + self.coordinatorUuid(), {\n      format: 'json'\n    }, function (data) {\n      $(document).trigger(\"showSubmitPopup\", data);\n    }).fail(function (xhr, textStatus, errorThrown) {\n      if (xhr.status !== 502) {\n        $(document).trigger(\"error\", xhr.responseText);\n      }\n    });\n  };\n\n  self.viewSchedulerId = ko.observable(typeof notebook.viewSchedulerId != \"undefined\" && notebook.viewSchedulerId != null ? notebook.viewSchedulerId : '');\n  self.viewSchedulerId.subscribe(function(newVal) {\n    self.save();\n  });\n  self.isSchedulerJobRunning = ko.observable();\n  self.loadingScheduler = ko.observable(false);\n\n\n  // Init\n  if (notebook.snippets) {\n    $.each(notebook.snippets, function (index, snippet) {\n      self.addSnippet(snippet);\n    });\n    if (typeof notebook.presentationSnippets != \"undefined\" && notebook.presentationSnippets != null) { // Load\n      $.each(notebook.presentationSnippets, function(key, snippet) {\n        snippet.status = 'ready' // Protect from storm of check_statuses\n        let _snippet = new Snippet(vm, self, snippet);\n        _snippet.init();\n        _snippet.previousChartOptions = vm._getPreviousChartOptions(_snippet);\n        self.presentationSnippets()[key] = _snippet;\n      });\n    }\n    if (vm.editorMode() && self.history().length == 0) {\n      self.fetchHistory(function() {\n        self.updateHistory(['starting', 'running'], 30000);\n        self.updateHistory(['available'], 60000 * 5);\n      });\n    }\n  }\n\n  huePubSub.subscribeOnce('assist.db.panel.ready', function () {\n    if (self.type().indexOf('query') === 0) {\n\n      let whenDatabaseAvailable = function (snippet) {\n        huePubSub.publish('assist.set.database', {\n          source: snippet.type(),\n          namespace: snippet.namespace(),\n          name: snippet.database()\n        });\n      };\n\n      let whenNamespaceAvailable = function (snippet) {\n        if (snippet.database()) {\n          whenDatabaseAvailable(snippet);\n        } else {\n          let databaseSub = snippet.database.subscribe(function () {\n            databaseSub.dispose();\n            whenDatabaseAvailable(snippet);\n          })\n        }\n      };\n\n      let whenSnippetAvailable = function (snippet) {\n        if (snippet.namespace()) {\n          whenNamespaceAvailable(snippet);\n        } else {\n          let namespaceSub = snippet.namespace.subscribe(function () {\n            namespaceSub.dispose();\n            whenNamespaceAvailable(snippet);\n          })\n        }\n      };\n\n      if (self.snippets().length === 1) {\n        whenSnippetAvailable(self.snippets()[0]);\n      } else {\n        let snippetsSub = self.snippets.subscribe(function (snippets) {\n          if (snippets.length === 1) {\n            whenSnippetAvailable(snippets[0])\n          }\n          snippetsSub.dispose();\n        })\n      }\n    }\n  }, vm.huePubSubId);\n\n  huePubSub.publish('assist.is.db.panel.ready');\n};\n\nfunction EditorViewModel(editor_id, notebooks, options, CoordinatorEditorViewModel, RunningCoordinatorModel) {\n  let self = this;\n\n  self.URLS = {\n    editor: '/notebook/editor',\n    editorMobile: '/notebook/editor_m',\n    notebook: '/notebook/notebook',\n    hue4: '/hue/editor',\n    hue4_notebook: '/hue/notebook',\n    report: '/hue/dashboard/new_search?engine=report'\n  };\n\n  self.huePubSubId = options.huePubSubId || 'editor';\n  self.user = options.user;\n  self.userId = options.userId;\n  self.suffix = options.suffix;\n  self.isMobile = ko.observable(options.mobile);\n  self.isHue4 = ko.observable(options.hue4);\n  self.isNotificationManager = ko.observable(options.is_notification_manager || false);\n  self.editorType = ko.observable(options.editor_type);\n  self.editorType.subscribe(function(newVal) {\n    self.editorMode(newVal != 'notebook');\n    hueUtils.changeURLParameter('type', newVal);\n    if (self.editorMode()) {\n      self.selectedNotebook().fetchHistory(); // Js error if notebook did not have snippets\n    }\n  });\n  self.preEditorTogglingSnippet = ko.observable();\n  self.toggleEditorMode = function() {\n    let _notebook = self.selectedNotebook();\n    let _newSnippets = [];\n\n    if (self.editorType() != 'notebook') {\n      self.editorType('notebook');\n      self.preEditorTogglingSnippet(_notebook.snippets()[0]);\n      let _variables = _notebook.snippets()[0].variables();\n      let _statementKeys = [];\n      // Split statements\n      _notebook.type('notebook');\n      _notebook.snippets()[0].statementsList().forEach(function (sql_statement) {\n        let _snippet;\n        if (sql_statement.hashCode() in _notebook.presentationSnippets()) {\n          _snippet = _notebook.presentationSnippets()[sql_statement.hashCode()]; // Persist result\n          _snippet.variables(_variables);\n        } else {\n          let _title = [];\n          let _statement = [];\n          sql_statement.trim().split('\\n').forEach(function(line) {\n            if (line.trim().startsWith('--') && _statement.length === 0) {\n              _title.push(line.substr(2));\n            } else {\n              _statement.push(line);\n            }\n          });\n          _snippet = new Snippet(self, _notebook, {type: _notebook.initialType, statement_raw: _statement.join('\\n'), result: {}, name: _title.join('\\n'), variables: komapping.toJS(_variables)});\n          _snippet.variables = _notebook.snippets()[0].variables;\n          _snippet.init();\n          _notebook.presentationSnippets()[sql_statement.hashCode()] = _snippet;\n        }\n        _statementKeys.push(sql_statement.hashCode());\n        _newSnippets.push(_snippet);\n      });\n      $.each(_notebook.presentationSnippets(), function(key) { // Dead statements\n        if (! key in _statementKeys) {\n          delete _notebook.presentationSnippets()[key];\n        }\n      });\n    } else {\n      self.editorType(_notebook.initialType);\n      // Revert to one statement\n      _newSnippets.push(self.preEditorTogglingSnippet());\n      _notebook.type('query-' + _notebook.initialType);\n    }\n    _notebook.snippets(_newSnippets);\n    _newSnippets.forEach(function (snippet) {\n      huePubSub.publish('editor.redraw.data', {snippet: snippet});\n    });\n  };\n  self.togglePresentationMode = function() {\n    if (self.selectedNotebook().initialType !== 'notebook') {\n      self.toggleEditorMode();\n    }\n  };\n  self.editorTypeTitle = ko.pureComputed(function () {\n    let foundInterpreter = $.grep(options.languages, function (interpreter) {\n      return interpreter.type === self.editorType();\n    });\n    return foundInterpreter.length > 0 ? foundInterpreter[0].name : self.editorType();\n  });\n  self.useNewAutocompleter = options.useNewAutocompleter || false;\n  self.autocompleteTimeout = options.autocompleteTimeout;\n  self.selectedNotebook = ko.observable();\n\n  self.combinedContent = ko.observable();\n  self.isPresentationModeEnabled = ko.pureComputed(function () {\n    return self.selectedNotebook() && self.selectedNotebook().snippets().length === 1 && self.selectedNotebook().snippets()[0].isSqlDialect()\n  });\n  self.isResultFullScreenMode = ko.observable(false);\n  self.isPresentationMode = ko.computed(function() {\n    return self.selectedNotebook() && self.selectedNotebook().isPresentationMode();\n  });\n  self.isHidingCode = ko.computed(function() {\n    return self.selectedNotebook() && self.selectedNotebook().isHidingCode();\n  })\n  self.successUrl = ko.observable(options.success_url); // Deprecated\n  self.isOptimizerEnabled = ko.observable(options.is_optimizer_enabled);\n  self.isNavigatorEnabled = ko.observable(options.is_navigator_enabled);\n\n  self.CoordinatorEditorViewModel = CoordinatorEditorViewModel;\n  self.RunningCoordinatorModel = RunningCoordinatorModel;\n\n  self.canSave = ko.computed(function() {\n    // Saved query or history but history coming from a saved query\n    return self.selectedNotebook() && self.selectedNotebook().canWrite() && (\n        self.selectedNotebook().isSaved() ||\n        (self.selectedNotebook().isHistory() && self.selectedNotebook().parentSavedQueryUuid())\n    );\n  });\n\n  // TODO: Drop the SQL source types from the notebook. They're now set in AssistDbPanel.\n  self.sqlSourceTypes = [];\n  self.availableLanguages = [];\n\n  if (options.languages && options.snippetViewSettings) {\n    $.each(options.languages, function (idx, language) {\n      self.availableLanguages.push({\n        type: language.type,\n        name: language.name,\n        interface: language.interface\n      });\n      let viewSettings = options.snippetViewSettings[language.type];\n      if (viewSettings && viewSettings.sqlDialect) {\n        self.sqlSourceTypes.push({\n          type: language.type,\n          name: language.name\n        })\n      }\n    });\n  }\n\n  let sqlSourceTypes = $.grep(self.sqlSourceTypes, function(language) { return language.type == self.editorType(); });\n  if (sqlSourceTypes.length > 0) {\n    self.activeSqlSourceType = sqlSourceTypes[0].type;\n  } else {\n    self.activeSqlSourceType = null;\n  }\n\n  self.displayCombinedContent = function () {\n    if (! self.selectedNotebook()) {\n      self.combinedContent('');\n    } else {\n      let statements = '';\n      $.each(self.selectedNotebook().snippets(), function (index, snippet) {\n        if (snippet.statement()) {\n          if (statements) {\n            statements += '\\n\\n';\n          }\n          statements += snippet.statement();\n        }\n      });\n      self.combinedContent(statements);\n    }\n    $(\"#combinedContentModal\" + self.suffix).modal(\"show\");\n  };\n\n  self.isEditing = ko.observable(false);\n  self.isEditing.subscribe(function () {\n    $(document).trigger(\"editingToggled\");\n  });\n  self.toggleEditing = function () {\n    self.isEditing(! self.isEditing());\n  };\n\n  self.authSessionUsername = ko.observable(); // UI popup\n  self.authSessionPassword = ko.observable();\n  self.authSessionType = ko.observable();\n  self.authSessionCallback = ko.observable();\n\n  self.removeSnippetConfirmation = ko.observable();\n\n  self.removeSnippet = function (notebook, snippet) {\n    let hasContent = snippet.statement_raw().length > 0;\n    if (!hasContent) {\n      $.each(snippet.properties(), function (key, value) {\n        hasContent = hasContent || (ko.isObservable(value) && value().length > 0);\n      });\n    }\n    if (hasContent) {\n      self.removeSnippetConfirmation({ notebook: notebook, snippet: snippet });\n      $(\"#removeSnippetModal\" + self.suffix).modal(\"show\");\n    }\n    else {\n      notebook.snippets.remove(snippet);\n      window.setTimeout(function () {\n        $(document).trigger(\"editorSizeChanged\");\n      }, 100);\n    }\n  };\n\n  self.assistAvailable = ko.observable(options.assistAvailable);\n\n  self.assistWithoutStorage = ko.observable(false);\n\n  self.isLeftPanelVisible = ko.observable(apiHelper.getFromTotalStorage('assist', 'assist_panel_visible', true));\n  self.isLeftPanelVisible.subscribe(function (val) {\n    if (!self.assistWithoutStorage()){\n      apiHelper.setInTotalStorage('assist', 'assist_panel_visible', val);\n    }\n  });\n\n  self.isRightPanelAvailable = ko.observable(options.assistAvailable && HAS_OPTIMIZER);\n  self.isRightPanelVisible = ko.observable(apiHelper.getFromTotalStorage('assist', 'right_assist_panel_visible', true));\n  self.isRightPanelVisible.subscribe(function (val) {\n    if (!self.assistWithoutStorage()){\n      apiHelper.setInTotalStorage('assist', 'right_assist_panel_visible', val);\n    }\n  });\n\n  let withActiveSnippet = function (callback) {\n    let notebook = self.selectedNotebook();\n    let foundSnippet;\n    if (notebook) {\n      if (notebook.snippets().length === 1) {\n        foundSnippet = notebook.snippets()[0];\n      } else {\n        notebook.snippets().every(function (snippet) {\n          if (snippet.inFocus()) {\n            foundSnippet = snippet;\n            return false;\n          }\n          return true;\n        });\n      }\n    }\n    if (foundSnippet) {\n      callback(foundSnippet);\n    }\n  };\n\n  huePubSub.subscribe('assist.highlight.risk.suggestions', function () {\n    if (self.isRightPanelAvailable() && !self.isRightPanelVisible()) {\n      self.isRightPanelVisible(true);\n    }\n  });\n\n  self.isContextPanelVisible = ko.observable(false);\n  self.isContextPanelVisible.subscribe(function (newValue) {\n    huePubSub.publish('context.panel.visible', newValue);\n  });\n\n  huePubSub.subscribe('context.panel.visible.editor', self.isContextPanelVisible);\n\n  huePubSub.subscribe('get.active.snippet.type', function () {\n    withActiveSnippet(function (activeSnippet) {\n      huePubSub.publish('set.active.snippet.type', activeSnippet.type());\n    })\n  }, self.huePubSubId);\n\n  huePubSub.subscribe('save.snippet.to.file', function() {\n    withActiveSnippet(function (activeSnippet) {\n      let data = {\n        path: activeSnippet.statementPath(),\n        contents: activeSnippet.statement()\n      };\n      let options = {\n        successCallback: function (result) {\n          if (result && result.exists) {\n            $(document).trigger(\"info\", result.path + ' saved successfully.');\n          } else {\n            self._ajaxError(result);\n          }\n        }\n      };\n      apiHelper.saveSnippetToFile(data, options);\n    });\n  }, self.huePubSubId);\n\n  huePubSub.subscribe('sql.context.pin', function (contextData) {\n    withActiveSnippet(function (activeSnippet) {\n      contextData.tabId = 'context' + activeSnippet.pinnedContextTabs().length;\n      activeSnippet.pinnedContextTabs.push(contextData);\n      activeSnippet.currentQueryTab(contextData.tabId);\n    });\n  }, self.huePubSubId);\n\n  huePubSub.subscribe(\"assist.database.set\", function (databaseDef) {\n    withActiveSnippet(function (activeSnippet) {\n      activeSnippet.handleAssistSelection(databaseDef);\n    });\n  }, self.huePubSubId);\n\n  huePubSub.subscribe(\"assist.database.selected\", function (databaseDef) {\n    withActiveSnippet(function (activeSnippet) {\n      activeSnippet.handleAssistSelection(databaseDef);\n    });\n  }, self.huePubSubId);\n\n  self.availableSnippets = komapping.fromJS(options.languages);\n\n  self.editorMode = ko.observable(options.mode == 'editor');\n\n  self.getSnippetViewSettings = function (snippetType) {\n    if (options.snippetViewSettings[snippetType]) {\n      return options.snippetViewSettings[snippetType];\n    }\n    return options.snippetViewSettings.default;\n  };\n\n  self.availableSessionProperties = ko.computed(function () { // Only Spark\n    return ko.utils.arrayFilter(options.session_properties, function (item) {\n      return item.name != ''; // Could filter out the ones already selected + yarn only or not\n    });\n  });\n  self.getSessionProperties = function(name) {\n    let _prop = null;\n    $.each(options.session_properties, function(index, prop) {\n      if (prop.name == name) {\n        _prop = prop;\n        return;\n      }\n    });\n    return _prop;\n  };\n\n  self.getSnippetName = function(snippetType)  {\n    let availableSnippets = self.availableSnippets();\n    for (let i = 0; i < availableSnippets.length; i++) {\n      if (availableSnippets[i].type() === snippetType) {\n        return availableSnippets[i].name();\n      }\n    }\n    return '';\n  };\n\n  self.changeURL = function (url) {\n    if (!self.isNotificationManager()) {\n      hueUtils.changeURL(url);\n    }\n  };\n\n  self.init = function () {\n    if (editor_id) {\n      self.openNotebook(editor_id);\n    } else if (window.location.getParameter('editor') !== ''){\n      self.openNotebook(window.location.getParameter('editor'));\n    } else if (notebooks.length > 0) {\n      self.loadNotebook(notebooks[0]); // Old way of loading json for /browse\n    } else if (window.location.getParameter('type') !== '') {\n      self.newNotebook(window.location.getParameter('type'));\n    } else {\n      self.newNotebook();\n    }\n  };\n\n  self.loadNotebook = function (notebookRaw, queryTab) {\n    let currentQueries;\n    if (self.selectedNotebook() != null) {\n      currentQueries = self.selectedNotebook().unload();\n    }\n\n    let notebook = new Notebook(self, notebookRaw);\n\n    if (notebook.snippets().length > 0) {\n      huePubSub.publish('detach.scrolls', notebook.snippets()[0]);\n      notebook.selectedSnippet(notebook.snippets()[notebook.snippets().length - 1].type());\n      if (currentQueries != null) {\n        notebook.snippets()[0].queries(currentQueries);\n      }\n      notebook.snippets().forEach(function (snippet) {\n        snippet.aceAutoExpand = false;\n        snippet.statement_raw.valueHasMutated();\n        if (snippet.result.handle().statements_count > 1 && snippet.result.handle().start != null && snippet.result.handle().end != null) {\n          let aceLineOffset = snippet.result.handle().aceLineOffset || 0;\n          snippet.result.statement_range({\n            start: { row: snippet.result.handle().start.row + aceLineOffset, column: snippet.result.handle().start.column },\n            end: { row: snippet.result.handle().end.row + aceLineOffset, column: snippet.result.handle().end.column }\n          });\n          snippet.result.statement_range.valueHasMutated();\n        }\n\n        snippet.previousChartOptions = self._getPreviousChartOptions(snippet);\n      });\n\n      if (notebook.snippets()[0].result.data().length > 0) {\n        $(document).trigger(\"redrawResults\");\n      } else if (queryTab) {\n        notebook.snippets()[0].currentQueryTab(queryTab);\n      }\n\n      if (notebook.isSaved()) {\n        notebook.snippets()[0].currentQueryTab('savedQueries');\n        if (notebook.snippets()[0].queries().length === 0) {\n          notebook.snippets()[0].fetchQueries(); // Subscribe not updating yet\n        }\n      }\n    }\n\n    self.selectedNotebook(notebook);\n    huePubSub.publish('check.job.browser');\n    huePubSub.publish('recalculate.name.description.width');\n  };\n\n  self._getPreviousChartOptions = function(snippet) {\n    return {\n        chartLimit: typeof snippet.chartLimit() !== \"undefined\" ? snippet.chartLimit() : snippet.previousChartOptions.chartLimit,\n        chartX: typeof snippet.chartX() !== \"undefined\" ? snippet.chartX() : snippet.previousChartOptions.chartX,\n        chartXPivot: typeof snippet.chartXPivot() !== \"undefined\" ? snippet.chartXPivot() : snippet.previousChartOptions.chartXPivot,\n        chartYSingle: typeof snippet.chartYSingle() !== \"undefined\" ? snippet.chartYSingle() : snippet.previousChartOptions.chartYSingle,\n        chartMapType: typeof snippet.chartMapType() !== \"undefined\" ? snippet.chartMapType() : snippet.previousChartOptions.chartMapType,\n        chartMapLabel: typeof snippet.chartMapLabel() !== \"undefined\" ? snippet.chartMapLabel() : snippet.previousChartOptions.chartMapLabel,\n        chartMapHeat: typeof snippet.chartMapHeat() !== \"undefined\" ? snippet.chartMapHeat() : snippet.previousChartOptions.chartMapHeat,\n        chartYMulti: typeof snippet.chartYMulti() !== \"undefined\" ? snippet.chartYMulti() : snippet.previousChartOptions.chartYMulti,\n        chartScope: typeof snippet.chartScope() !== \"undefined\" ? snippet.chartScope() : snippet.previousChartOptions.chartScope,\n        chartTimelineType: typeof snippet.chartTimelineType() !== \"undefined\" ? snippet.chartTimelineType() : snippet.previousChartOptions.chartTimelineType,\n        chartSorting: typeof snippet.chartSorting() !== \"undefined\" ? snippet.chartSorting() : snippet.previousChartOptions.chartSorting,\n        chartScatterGroup: typeof snippet.chartScatterGroup() !== \"undefined\" ? snippet.chartScatterGroup() : snippet.previousChartOptions.chartScatterGroup,\n        chartScatterSize: typeof snippet.chartScatterSize() !== \"undefined\" ? snippet.chartScatterSize() : snippet.previousChartOptions.chartScatterSize\n      };\n  };\n\n  self.openNotebook = function (uuid, queryTab, skipUrlChange, callback) {\n    let deferredOpen = new $.Deferred();\n    $.get('/desktop/api2/doc/', {\n      uuid: uuid,\n      data: true,\n      dependencies: true\n    }, function (data) {\n      if (data.status == 0) {\n        data.data.dependents = data.dependents;\n        data.data.can_write = data.user_perms.can_write;\n        let notebook = data.data;\n        self.loadNotebook(notebook, queryTab);\n        if (typeof skipUrlChange === 'undefined' && ! self.isNotificationManager()){\n          if (self.editorMode()) {\n            self.editorType(data.document.type.substring('query-'.length));\n            huePubSub.publish('active.snippet.type.changed', self.editorType());\n            if (self.isHue4()){\n              self.changeURL(self.URLS.hue4 + '?editor=' + data.document.id + '&type=' + self.editorType());\n            } else {\n              self.changeURL((self.isMobile() ? self.URLS.editorMobile : self.URLS.editor) + '?editor=' + data.document.id + '&type=' + self.editorType());\n            }\n          } else {\n            if (self.isHue4()){\n              self.changeURL(self.URLS.hue4_notebook + '?notebook=' + data.document.id);\n            } else {\n              self.changeURL(self.URLS.notebook + '?notebook=' + data.document.id);\n            }\n          }\n        }\n        if (typeof callback !== 'undefined'){\n          callback();\n        }\n        deferredOpen.resolve();\n      }\n      else {\n        $(document).trigger(\"error\", data.message);\n        deferredOpen.reject();\n        self.newNotebook();\n      }\n    });\n    return deferredOpen.promise();\n  };\n\n  self.newNotebook = function (editorType, callback, queryTab) {\n    huePubSub.publish('active.snippet.type.changed', editorType);\n    $.post(\"/notebook/api/create_notebook\", {\n      type: editorType || options.editor_type,\n      directory_uuid: window.location.getParameter('directory_uuid')\n    }, function (data) {\n      self.loadNotebook(data.notebook);\n      if (self.editorMode() && !self.isNotificationManager()) {\n        let snippet = self.selectedNotebook().newSnippet(self.editorType());\n        if (queryTab && ['queryHistory', 'savedQueries', 'queryBuilderTab'].indexOf(queryTab) > -1) {\n          snippet.currentQueryTab(queryTab);\n        }\n        huePubSub.publish('detach.scrolls', self.selectedNotebook().snippets()[0]);\n        if (window.location.getParameter('type') === '') {\n          hueUtils.changeURLParameter('type', self.editorType());\n        }\n        huePubSub.publish('active.snippet.type.changed', editorType);\n      }\n\n      if (typeof callback !== 'undefined' && callback !== null){\n        callback();\n      }\n    });\n  };\n\n  self.saveNotebook = function () {\n    self.selectedNotebook().save();\n  };\n\n  self.saveAsNotebook = function () {\n    self.selectedNotebook().id(null);\n    self.selectedNotebook().uuid(hueUtils.UUID());\n    self.selectedNotebook().parentSavedQueryUuid(null);\n    self.selectedNotebook().save(function () {\n      huePubSub.publish('assist.document.refresh');\n    });\n  };\n\n  self.showContextPopover = function (field, event) {\n    let $source = $(event.target && event.target.nodeName !== 'A' ? event.target.parentElement : event.target);\n    let offset = $source.offset();\n    huePubSub.publish('context.popover.show', {\n      data: {\n        type: 'catalogEntry',\n        catalogEntry: field.catalogEntry\n      },\n      onSampleClick: field.value,\n      showInAssistEnabled: true,\n      sourceType: self.editorType(),\n      orientation: 'bottom',\n      defaultDatabase: 'default',\n      pinEnabled: false,\n      source: {\n        element: event.target,\n        left: offset.left,\n        top: offset.top - 3,\n        right: offset.left + $source.width() + 1,\n        bottom: offset.top + $source.height() - 3\n      }\n    });\n  };\n}\n\nexport default EditorViewModel;\n","/* =========================================================\n * bootstrap-datepicker.js \n * http://www.eyecon.ro/bootstrap-datepicker\n * =========================================================\n * Copyright 2012 Stefan Petre\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * ========================================================= */\n\nimport $ from 'jquery';\n\n!function(e){var t=function(t,r){this.element=e(t);this.format=n.parseFormat(r.format||this.element.data(\"date-format\")||\"mm/dd/yyyy\");this.picker=e(n.template).appendTo(\"body\").on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)});this.isInput=this.element.is(\"input\");this.component=this.element.is(\".date\")?this.element.find(\".add-on\"):!1;this.isInput?this.element.on({focus:e.proxy(this.show,this),blur:e.proxy(this.hide,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on(\"click\",e.proxy(this.show,this)):this.element.on(\"click\",e.proxy(this.show,this));this.minViewMode=r.minViewMode||this.element.data(\"date-minviewmode\")||0;if(typeof this.minViewMode==\"string\")switch(this.minViewMode){case\"months\":this.minViewMode=1;break;case\"years\":this.minViewMode=2;break;default:this.minViewMode=0}this.viewMode=r.viewMode||this.element.data(\"date-viewmode\")||0;if(typeof this.viewMode==\"string\")switch(this.viewMode){case\"months\":this.viewMode=1;break;case\"years\":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode;this.weekStart=r.weekStart||this.element.data(\"date-weekstart\")||0;this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.fillDow();this.fillMonths();this.update();this.showMode()};t.prototype={constructor:t,show:function(t){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();e(window).on(\"resize\",e.proxy(this.place,this));if(t){t.stopPropagation();t.preventDefault()}this.isInput||e(document).on(\"mousedown\",e.proxy(this.hide,this));this.element.trigger({type:\"show\",date:this.date})},hide:function(){this.picker.hide();e(window).off(\"resize\",this.place);this.viewMode=this.startViewMode;this.showMode();this.isInput||e(document).off(\"mousedown\",this.hide);this.set();this.element.trigger({type:\"hide\",date:this.date})},set:function(){var e=n.formatDate(this.date,this.format);if(!this.isInput){this.component&&this.element.find(\"input\").prop(\"value\",e);this.element.data(\"date\",e)}else this.element.prop(\"value\",e)},setValue:function(e){typeof e==\"string\"?this.date=n.parseDate(e,this.format):this.date=new Date(e);this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},update:function(e){this.date=n.parseDate(typeof e==\"string\"?e:this.isInput?this.element.prop(\"value\"):this.element.data(\"date\"),this.format);this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},fillDow:function(){var e=this.weekStart,t=\"<tr>\";while(e<this.weekStart+7)t+='<th class=\"dow\">'+n.dates.daysMin[e++%7]+\"</th>\";t+=\"</tr>\";this.picker.find(\".datepicker-days thead\").append(t)},fillMonths:function(){var e=\"\",t=0;while(t<12)e+='<span class=\"month\">'+n.dates.monthsShort[t++]+\"</span>\";this.picker.find(\".datepicker-months td\").append(e)},fill:function(){var e=new Date(this.viewDate),t=e.getFullYear(),r=e.getMonth(),i=this.date.valueOf();this.picker.find(\".datepicker-days th:eq(1)\").text(n.dates.months[r]+\" \"+t);var s=new Date(t,r-1,28,0,0,0,0),o=n.getDaysInMonth(s.getFullYear(),s.getMonth());s.setDate(o);s.setDate(o-(s.getDay()-this.weekStart+7)%7);var u=new Date(s);u.setDate(u.getDate()+42);u=u.valueOf();html=[];var a;while(s.valueOf()<u){s.getDay()===this.weekStart&&html.push(\"<tr>\");a=\"\";s.getMonth()<r?a+=\" old\":s.getMonth()>r&&(a+=\" new\");s.valueOf()===i&&(a+=\" active\");html.push('<td class=\"day'+a+'\">'+s.getDate()+\"</td>\");s.getDay()===this.weekEnd&&html.push(\"</tr>\");s.setDate(s.getDate()+1)}this.picker.find(\".datepicker-days tbody\").empty().append(html.join(\"\"));var f=this.date.getFullYear(),l=this.picker.find(\".datepicker-months\").find(\"th:eq(1)\").text(t).end().find(\"span\").removeClass(\"active\");f===t&&l.eq(this.date.getMonth()).addClass(\"active\");html=\"\";t=parseInt(t/10,10)*10;var c=this.picker.find(\".datepicker-years\").find(\"th:eq(1)\").text(t+\"-\"+(t+9)).end().find(\"td\");t-=1;for(var h=-1;h<11;h++){html+='<span class=\"year'+(h===-1||h===10?\" old\":\"\")+(f===t?\" active\":\"\")+'\">'+t+\"</span>\";t+=1}c.html(html)},click:function(t){t.stopPropagation();t.preventDefault();var r=e(t.target).closest(\"span, td, th\");if(r.length===1)switch(r[0].nodeName.toLowerCase()){case\"th\":switch(r[0].className){case\"switch\":this.showMode(1);break;case\"prev\":case\"next\":this.viewDate[\"set\"+n.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate[\"get\"+n.modes[this.viewMode].navFnc].call(this.viewDate)+n.modes[this.viewMode].navStep*(r[0].className===\"prev\"?-1:1));this.fill();this.set()}break;case\"span\":if(r.is(\".month\")){var i=r.parent().find(\"span\").index(r);this.viewDate.setMonth(i)}else{var s=parseInt(r.text(),10)||0;this.viewDate.setFullYear(s)}if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:\"changeDate\",date:this.date,viewMode:n.modes[this.viewMode].clsName})}this.showMode(-1);this.fill();this.set();break;case\"td\":if(r.is(\".day\")){var o=parseInt(r.text(),10)||1,i=this.viewDate.getMonth();r.is(\".old\")?i-=1:r.is(\".new\")&&(i+=1);var s=this.viewDate.getFullYear();this.date=new Date(s,i,o,0,0,0,0);this.viewDate=new Date(s,i,Math.min(28,o),0,0,0,0);this.fill();this.set();this.element.trigger({type:\"changeDate\",date:this.date,viewMode:n.modes[this.viewMode].clsName})}}},mousedown:function(e){e.stopPropagation();e.preventDefault()},showMode:function(e){e&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+e)));this.picker.find(\">div\").hide().filter(\".datepicker-\"+n.modes[this.viewMode].clsName).show()}};e.fn.datepicker=function(n,r){return this.each(function(){var i=e(this),s=i.data(\"datepicker\"),o=typeof n==\"object\"&&n;s||i.data(\"datepicker\",s=new t(this,e.extend({},e.fn.datepicker.defaults,o)));typeof n==\"string\"&&s[n](r)})};e.fn.datepicker.defaults={};e.fn.datepicker.Constructor=t;var n={modes:[{clsName:\"days\",navFnc:\"Month\",navStep:1},{clsName:\"months\",navFnc:\"FullYear\",navStep:1},{clsName:\"years\",navFnc:\"FullYear\",navStep:10}],dates:{days:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"],daysShort:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],daysMin:[\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\",\"Su\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],monthsShort:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},parseFormat:function(e){var t=e.match(/[.\\/\\-\\s].*?/),n=e.split(/\\W+/);if(!t||!n||n.length===0)throw new Error(\"Invalid date format.\");return{separator:t,parts:n}},parseDate:function(e,t){var n=e.split(t.separator),e=new Date,r;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);if(n.length===t.parts.length)for(var i=0,s=t.parts.length;i<s;i++){r=parseInt(n[i],10)||1;switch(t.parts[i]){case\"dd\":case\"d\":e.setDate(r);break;case\"mm\":case\"m\":e.setMonth(r-1);break;case\"yy\":e.setFullYear(2e3+r);break;case\"yyyy\":e.setFullYear(r)}}return e},formatDate:function(e,t){var n={d:e.getDate(),m:e.getMonth()+1,yy:e.getFullYear().toString().substring(2),yyyy:e.getFullYear()};n.dd=(n.d<10?\"0\":\"\")+n.d;n.mm=(n.m<10?\"0\":\"\")+n.m;var e=[];for(var r=0,i=t.parts.length;r<i;r++)e.push(n[t.parts[r]]);return e.join(t.separator)},headTemplate:'<thead><tr><th class=\"prev\">&lsaquo;</th><th colspan=\"5\" class=\"switch\"></th><th class=\"next\">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan=\"7\"></td></tr></tbody>'};n.template='<div class=\"datepicker dropdown-menu\"><div class=\"datepicker-days\"><table class=\" table-condensed\">'+n.headTemplate+\"<tbody></tbody>\"+\"</table>\"+\"</div>\"+'<div class=\"datepicker-months\">'+'<table class=\"table-condensed\">'+n.headTemplate+n.contTemplate+\"</table>\"+\"</div>\"+'<div class=\"datepicker-years\">'+'<table class=\"table-condensed\">'+n.headTemplate+n.contTemplate+\"</table>\"+\"</div>\"+\"</div>\"}($);","// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport jQuery from 'jquery';\n\nimport hueUtils from '../../utils/hueUtils';\n\n// TODO: don't create multiple jquery instances from chunks\nconst $ = window.$ || jQuery;\n\n/*\n * jHue HDFS tree plugin\n * shows a tree HDFS picker, if initialPath is set it pre-populates the path\n * if home is specified a home link will appear\n * use attached to an element, ie:\n * $(\"#el\").jHueHdfsTree({\n *    initialPath: \"/user\",\n *    home: \"/user/hue\"\n *    onPathChange: function (path) {\n *      console.log(path);\n *    }\n * });\n */\n\nlet pluginName = \"jHueHdfsTree\",\n    defaults = {\n      home: \"\",\n      initialPath: \"/\",\n      isS3: false,\n      withTopPadding: true,\n      onPathChange: function () {\n      },\n      createFolder: true,\n      labels: {\n        CREATE_FOLDER: \"Create folder\",\n        FOLDER_NAME: \"Folder name\",\n        CANCEL: \"Cancel\",\n        HOME: \"Home\"\n      }\n    };\n\nfunction Plugin(element, options) {\n  this.element = element;\n  this.options = $.extend({}, defaults, options);\n  this.options.labels = $.extend({}, defaults.labels, HUE_I18n.jHueHdfsTree, options ? options.labels : {});\n  this._defaults = defaults;\n  this._name = pluginName;\n  this.lastPath = \"\";\n  this.previousPath = \"\";\n  this.init();\n}\n\nPlugin.prototype.init = function (optionalPath) {\n  let _this = this;\n\n  if (typeof optionalPath != \"undefined\") {\n    _this.options.initialPath = optionalPath;\n  }\n  let _el = $(_this.element);\n  _el.empty();\n  _el.addClass(\"jHueHdfsTree\");\n\n  let _homeLink;\n  if (_this.options.home != \"\") {\n      _homeLink = $(\"<a>\").html('<i class=\"fa fa-home\"></i> ' + _this.options.labels.HOME).click(function () {\n      let _path = _this.options.home;\n      _this.options.onPathChange(_path);\n      _this.lastPath = _path;\n      _tree.find(\"a\").removeClass(\"selected\");\n      let _paths = [];\n      let _re = /\\//g;\n      while ((match = _re.exec(_path)) != null) {\n        _paths.push(_path.substr(0, match.index));\n      }\n      _paths.push(_path);\n\n      showHdfsLeaf({\n        paths: _paths,\n        scroll: true\n      });\n    });\n    _homeLink.css({\n      \"cursor\": \"pointer\",\n      \"position\": \"fixed\",\n      \"padding-bottom\": '4px',\n      \"font-size\": \"16px\",\n      \"border-bottom\": \"1px solid #FFF\",\n      \"background-color\": \"#FFF\",\n      \"width\": (560 - hueUtils.scrollbarWidth()) + \"px\"\n    })\n  }\n\n  let _tree = $(\"<ul>\").addClass(\"content unstyled\").html('<li><a class=\"pointer\"><i class=\"fa fa-folder-open-o\"></i> /</a></li>');\n  if (_this.options.withTopPadding) {\n    _tree.css(\"padding-top\", \"30px\");\n  }\n\n  if (_this.options.home != \"\") {\n    _homeLink.appendTo(_el);\n    _el.parent().on('scroll', function(){\n      if (_el.parent().scrollTop() > 0){\n        _homeLink.css({\n          \"border-bottom\": \"1px solid #EEE\"\n        });\n      }\n      else {\n        _homeLink.css({\n          \"border-bottom\": \"1px solid #FFF\"\n        });\n      }\n    });\n  }\n  _tree.appendTo(_el);\n\n\n  _tree.find(\"a\").on(\"click\", function () {\n    _this.options.onPathChange(\"/\");\n    _tree.find(\"a\").removeClass(\"selected\");\n    _tree.find(\"a:eq(0)\").addClass(\"selected\");\n  });\n\n  let _root = $(\"<ul>\").addClass(\"content unstyled\").attr(\"data-path\", \"__JHUEHDFSTREE__ROOT__\").attr(\"data-loaded\", \"true\");\n  _root.appendTo(_tree.find(\"li\"));\n\n  let BASE_PATH = \"/filebrowser/view=\";\n  let _currentFiles = [];\n\n  function escapeSingleQuote(path) {\n    return path.replace(/\\'/gi, \"\\\\'\");\n  }\n\n  function removeLeadingSlash(path) {\n    if (path.indexOf(\"/\") == 0) {\n      return path.substr(1);\n    }\n    return path;\n  }\n\n  function showHdfsLeaf(options) {\n    let autocompleteUrl = BASE_PATH,\n        currentPath = \"\";\n\n    if (options.paths != null && options.paths.length > 0) {\n      let shiftedPath = options.paths.shift();\n      if (_this.options.isS3){\n        currentPath = shiftedPath;\n      }\n      else {\n        currentPath = (shiftedPath != \"\" ? shiftedPath : \"/\");\n      }\n    }\n    else {\n      currentPath = (options.leaf != null ? options.leaf : \"/\");\n    }\n    autocompleteUrl += currentPath;\n    $.getJSON(autocompleteUrl + \"?pagesize=1000&format=json\", function (data) {\n      _currentFiles = [];\n      if (data.error == null) {\n        let filteredCurrentPath = _this.options.isS3 ? currentPath.substr(5) : currentPath;\n        let _dataPathForCurrent = filteredCurrentPath != \"\" ? removeLeadingSlash(filteredCurrentPath) : \"__JHUEHDFSTREE__ROOT__\";\n        _el.find(\"[data-path='\" + escapeSingleQuote(_dataPathForCurrent) + \"']\").attr(\"data-loaded\", true);\n        _el.find(\"[data-path='\" + escapeSingleQuote(_dataPathForCurrent) + \"']\").siblings(\"a\").find(\".fa-folder-o\").removeClass(\"fa-folder-o\").addClass(\"fa-folder-open-o\");\n        _tree.find(\"a\").removeClass(\"selected\");\n        _el.find(\"[data-path='\" + escapeSingleQuote(_dataPathForCurrent) + \"']\").siblings(\"a\").addClass(\"selected\");\n\n        if (options.scroll) {\n          _el.parent().scrollTop(_el.find(\"[data-path='\" + escapeSingleQuote(_dataPathForCurrent) + \"']\").siblings(\"a\").position().top + _el.parent().scrollTop() - 30);\n        }\n        $(data.files).each(function (cnt, item) {\n          if (item.name != \".\" && item.name != \"..\" && item.type == \"dir\") {\n            let _path = item.path;\n            let filteredPath = _this.options.isS3 ? _path.substr(5) : _path;\n            let _escapedPath = escapeSingleQuote(filteredPath);\n            if (_el.find(\"[data-path='\" + removeLeadingSlash(_escapedPath) + \"']\").length == 0) {\n              let _li = $(\"<li>\").html('<a class=\"pointer\"><i class=\"fa fa-folder-o\"></i> ' + item.name + '</a><ul class=\"content unstyled\" data-path=\"' + removeLeadingSlash(_escapedPath) + '\" data-loaded=\"false\"></ul>');\n              let _destination = filteredPath.substr(0, filteredPath.lastIndexOf(\"/\"));\n              if (_destination == \"\") {\n                _destination = \"__JHUEHDFSTREE__ROOT__\";\n              }\n              _destination = removeLeadingSlash(_destination);\n              _li.appendTo(_el.find(\"[data-path='\" + escapeSingleQuote(_destination) + \"']\"));\n              _li.find(\"a\").on(\"click\", function () {\n                _this.options.onPathChange(_path);\n                _this.lastPath = _path;\n                _tree.find(\"a\").removeClass(\"selected\");\n                _li.find(\"a:eq(0)\").addClass(\"selected\");\n                if (_li.find(\".content\").attr(\"data-loaded\") == \"false\") {\n                  showHdfsLeaf({\n                    leaf: _path,\n                    scroll: false\n                  });\n                }\n                else {\n                  if (_li.find(\".content\").is(\":visible\")) {\n                    _li.find(\".content\").hide();\n                  }\n                  else {\n                    _li.find(\".content\").show();\n                  }\n                }\n              });\n            }\n          }\n        });\n        if (_this.options.createFolder) {\n          let filteredCurrentPath = _this.options.isS3 ? currentPath.substr(5) : currentPath;\n          let _createFolderLi = $(\"<li>\").html('<a class=\"pointer\"><i class=\"fa fa-plus-square-o\"></i> ' + _this.options.labels.CREATE_FOLDER + '</a>');\n          _createFolderLi.appendTo(_el.find(\"[data-path='\" + removeLeadingSlash(escapeSingleQuote(filteredCurrentPath)) + \"']\"));\n\n          let _createFolderDetails = $(\"<form>\").css(\"margin-top\", \"10px\").addClass(\"form-inline\");\n          _createFolderDetails.hide();\n          let _folderName = $(\"<input>\").attr(\"type\", \"text\").attr(\"placeholder\", _this.options.labels.FOLDER_NAME).appendTo(_createFolderDetails);\n          $(\"<span> </span>\").appendTo(_createFolderDetails);\n          let _folderBtn = $(\"<input>\").attr(\"type\", \"button\").attr(\"value\", _this.options.labels.CREATE_FOLDER).addClass(\"btn primary\").appendTo(_createFolderDetails);\n          $(\"<span> </span>\").appendTo(_createFolderDetails);\n          let _folderCancel = $(\"<input>\").attr(\"type\", \"button\").attr(\"value\", _this.options.labels.CANCEL).addClass(\"btn\").appendTo(_createFolderDetails);\n          _folderCancel.click(function () {\n            _createFolderDetails.slideUp();\n          });\n          _folderBtn.click(function () {\n            $.ajax({\n              type: \"POST\",\n              url: \"/filebrowser/mkdir\",\n              data: {\n                name: _folderName.val(),\n                path: currentPath\n              },\n              beforeSend: function (xhr) {\n                xhr.setRequestHeader(\"X-Requested-With\", \"Hue\"); // need to override the default one because otherwise Django returns HTTP 500\n              },\n              success: function (xhr, status) {\n                if (status == \"success\") {\n                  _createFolderDetails.slideUp();\n                  let _newFolder = currentPath + \"/\" + _folderName.val();\n                  _this.init(_newFolder);\n                  _this.options.onPathChange(_newFolder);\n                }\n              }\n            });\n\n          });\n          _createFolderDetails.appendTo(_el.find(\"[data-path='\" + removeLeadingSlash(escapeSingleQuote(filteredCurrentPath)) + \"']\"));\n\n          _createFolderLi.find(\"a\").on(\"click\", function () {\n            _createFolderDetails.slideDown();\n          });\n        }\n        if (options.paths != null && options.paths.length > 0) {\n          showHdfsLeaf({\n            paths: options.paths,\n            scroll: options.scroll\n          });\n        }\n      }\n      else {\n        $.jHueNotify.error(data.error);\n      }\n    });\n  }\n\n  Plugin.prototype.showHdfsLeaf = showHdfsLeaf;\n\n  let _paths = [];\n  if (_this.options.initialPath != \"/\") {\n    let _re = /\\//g;\n    while ((match = _re.exec(_this.options.initialPath)) != null) {\n      _paths.push(_this.options.initialPath.substr(0, match.index));\n    }\n    _paths.push(_this.options.initialPath);\n  }\n\n  if (_this.options.isS3){\n    _paths.shift();\n    _paths[0] = 's3a://';\n  }\n\n  showHdfsLeaf({\n    paths: _paths\n  });\n\n};\n\nPlugin.prototype.setOptions = function (options) {\n  this.options = $.extend({}, defaults, options);\n};\n\n$.fn[pluginName] = function (options) {\n  return this.each(function () {\n    if (!$.data(this, 'plugin_' + pluginName)) {\n      $.data(this, 'plugin_' + pluginName, new Plugin(this, options));\n    }\n  });\n};\n\n$[pluginName] = function (options) {\n  if (typeof console != \"undefined\") {\n    console.warn(\"$(elem).jHueHdfsTree() is a preferred call method.\");\n  }\n  $(options.element).jHueHdfsTree(options);\n};"],"sourceRoot":""}